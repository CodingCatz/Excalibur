import{f as ae,d4 as Xn,d5 as Ht,d6 as wt,d7 as bt,d8 as lr,d9 as ur,r as T,j as D}from"./index-BO31ZqPg.js";import{i as Et}from"./value-kwUSg1GE.js";import{a as dr}from"./useDocumentSwitch-B2mv6tdu.js";function fr(e){let t;for(;t=e.sourceEvent;)e=t;return e}function ce(e,t){if(e=fr(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(t.getScreenCTM().inverse()),[o.x,o.y]}if(t.getBoundingClientRect){var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}}return[e.pageX,e.pageY]}const hr={passive:!1},Be={capture:!0,passive:!1};function vt(e){e.stopImmediatePropagation()}function ke(e){e.preventDefault(),e.stopImmediatePropagation()}function Wn(e){var t=e.document.documentElement,n=ae(e).on("dragstart.drag",ke,Be);"onselectstart"in t?n.on("selectstart.drag",ke,Be):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Gn(e,t){var n=e.document.documentElement,o=ae(e).on("dragstart.drag",null);t&&(o.on("click.drag",ke,Be),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Ue=e=>()=>e;function kt(e,{sourceEvent:t,subject:n,target:o,identifier:s,active:r,x:i,y:a,dx:f,dy:l,dispatch:h}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:r,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:f,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:h}})}kt.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function gr(e){return!e.ctrlKey&&!e.button}function pr(){return this.parentNode}function mr(e,t){return t??{x:e.x,y:e.y}}function yr(){return navigator.maxTouchPoints||"ontouchstart"in this}function Kn(){var e=gr,t=pr,n=mr,o=yr,s={},r=Xn("start","drag","end"),i=0,a,f,l,h,u=0;function c(m){m.on("mousedown.drag",y).filter(o).on("touchstart.drag",w).on("touchmove.drag",p,hr).on("touchend.drag touchcancel.drag",E).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function y(m,N){if(!(h||!e.call(this,m,N))){var v=d(this,t.call(this,m,N),m,N,"mouse");v&&(ae(m.view).on("mousemove.drag",g,Be).on("mouseup.drag",b,Be),Wn(m.view),vt(m),l=!1,a=m.clientX,f=m.clientY,v("start",m))}}function g(m){if(ke(m),!l){var N=m.clientX-a,v=m.clientY-f;l=N*N+v*v>u}s.mouse("drag",m)}function b(m){ae(m.view).on("mousemove.drag mouseup.drag",null),Gn(m.view,l),ke(m),s.mouse("end",m)}function w(m,N){if(e.call(this,m,N)){var v=m.changedTouches,C=t.call(this,m,N),$=v.length,z,B;for(z=0;z<$;++z)(B=d(this,C,m,N,v[z].identifier,v[z]))&&(vt(m),B("start",m,v[z]))}}function p(m){var N=m.changedTouches,v=N.length,C,$;for(C=0;C<v;++C)($=s[N[C].identifier])&&(ke(m),$("drag",m,N[C]))}function E(m){var N=m.changedTouches,v=N.length,C,$;for(h&&clearTimeout(h),h=setTimeout(function(){h=null},500),C=0;C<v;++C)($=s[N[C].identifier])&&(vt(m),$("end",m,N[C]))}function d(m,N,v,C,$,z){var B=r.copy(),k=ce(z||v,N),A,L,x;if((x=n.call(m,new kt("beforestart",{sourceEvent:v,target:c,identifier:$,active:i,x:k[0],y:k[1],dx:0,dy:0,dispatch:B}),C))!=null)return A=x.x-k[0]||0,L=x.y-k[1]||0,function M(S,P,I){var _=k,H;switch(S){case"start":s[$]=M,H=i++;break;case"end":delete s[$],--i;case"drag":k=ce(I||P,N),H=i;break}B.call(S,m,new kt(S,{sourceEvent:P,subject:x,target:c,identifier:$,active:H,x:k[0]+A,y:k[1]+L,dx:k[0]-_[0],dy:k[1]-_[1],dispatch:B}),C)}}return c.filter=function(m){return arguments.length?(e=typeof m=="function"?m:Ue(!!m),c):e},c.container=function(m){return arguments.length?(t=typeof m=="function"?m:Ue(m),c):t},c.subject=function(m){return arguments.length?(n=typeof m=="function"?m:Ue(m),c):n},c.touchable=function(m){return arguments.length?(o=typeof m=="function"?m:Ue(!!m),c):o},c.on=function(){var m=r.on.apply(r,arguments);return m===r?c:m},c.clickDistance=function(m){return arguments.length?(u=(m=+m)*m,c):Math.sqrt(u)},c}var xr=1e-12;function on(e){return((e=Math.exp(e))+1/e)/2}function wr(e){return((e=Math.exp(e))-1/e)/2}function br(e){return((e=Math.exp(2*e))-1)/(e+1)}const ot=(function e(t,n,o){function s(r,i){var a=r[0],f=r[1],l=r[2],h=i[0],u=i[1],c=i[2],y=h-a,g=u-f,b=y*y+g*g,w,p;if(b<xr)p=Math.log(c/l)/t,w=function(C){return[a+C*y,f+C*g,l*Math.exp(t*C*p)]};else{var E=Math.sqrt(b),d=(c*c-l*l+o*b)/(2*l*n*E),m=(c*c-l*l-o*b)/(2*c*n*E),N=Math.log(Math.sqrt(d*d+1)-d),v=Math.log(Math.sqrt(m*m+1)-m);p=(v-N)/t,w=function(C){var $=C*p,z=on(N),B=l/(n*E)*(z*br(t*$+N)-wr(N));return[a+B*y,f+B*g,l*z/on(t*$+N)]}}return w.duration=p*1e3*t/Math.SQRT2,w}return s.rho=function(r){var i=Math.max(.001,+r),a=i*i,f=a*a;return e(i,a,f)},s})(Math.SQRT2,2,4),Qe=e=>()=>e;function Er(e,{sourceEvent:t,target:n,transform:o,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:s}})}function St(e){e.stopImmediatePropagation()}function Re(e){e.preventDefault(),e.stopImmediatePropagation()}function vr(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Sr(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function sn(){return this.__zoom||Ht}function Nr(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Cr(){return navigator.maxTouchPoints||"ontouchstart"in this}function Mr(e,t,n){var o=e.invertX(t[0][0])-n[0][0],s=e.invertX(t[1][0])-n[1][0],r=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s),i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i))}function qn(){var e=vr,t=Sr,n=Mr,o=Nr,s=Cr,r=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],a=250,f=ot,l=Xn("start","zoom","end"),h,u,c,y=500,g=150,b=0,w=10;function p(x){x.property("__zoom",sn).on("wheel.zoom",$,{passive:!1}).on("mousedown.zoom",z).on("dblclick.zoom",B).filter(s).on("touchstart.zoom",k).on("touchmove.zoom",A).on("touchend.zoom touchcancel.zoom",L).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}p.transform=function(x,M,S,P){var I=x.selection?x.selection():x;I.property("__zoom",sn),x!==I?N(x,M,S,P):I.interrupt().each(function(){v(this,arguments).event(P).start().zoom(null,typeof M=="function"?M.apply(this,arguments):M).end()})},p.scaleBy=function(x,M,S,P){p.scaleTo(x,function(){var I=this.__zoom.k,_=typeof M=="function"?M.apply(this,arguments):M;return I*_},S,P)},p.scaleTo=function(x,M,S,P){p.transform(x,function(){var I=t.apply(this,arguments),_=this.__zoom,H=S==null?m(I):typeof S=="function"?S.apply(this,arguments):S,V=_.invert(H),R=typeof M=="function"?M.apply(this,arguments):M;return n(d(E(_,R),H,V),I,i)},S,P)},p.translateBy=function(x,M,S,P){p.transform(x,function(){return n(this.__zoom.translate(typeof M=="function"?M.apply(this,arguments):M,typeof S=="function"?S.apply(this,arguments):S),t.apply(this,arguments),i)},null,P)},p.translateTo=function(x,M,S,P,I){p.transform(x,function(){var _=t.apply(this,arguments),H=this.__zoom,V=P==null?m(_):typeof P=="function"?P.apply(this,arguments):P;return n(Ht.translate(V[0],V[1]).scale(H.k).translate(typeof M=="function"?-M.apply(this,arguments):-M,typeof S=="function"?-S.apply(this,arguments):-S),_,i)},P,I)};function E(x,M){return M=Math.max(r[0],Math.min(r[1],M)),M===x.k?x:new wt(M,x.x,x.y)}function d(x,M,S){var P=M[0]-S[0]*x.k,I=M[1]-S[1]*x.k;return P===x.x&&I===x.y?x:new wt(x.k,P,I)}function m(x){return[(+x[0][0]+ +x[1][0])/2,(+x[0][1]+ +x[1][1])/2]}function N(x,M,S,P){x.on("start.zoom",function(){v(this,arguments).event(P).start()}).on("interrupt.zoom end.zoom",function(){v(this,arguments).event(P).end()}).tween("zoom",function(){var I=this,_=arguments,H=v(I,_).event(P),V=t.apply(I,_),R=S==null?m(V):typeof S=="function"?S.apply(I,_):S,F=Math.max(V[1][0]-V[0][0],V[1][1]-V[0][1]),O=I.__zoom,W=typeof M=="function"?M.apply(I,_):M,q=f(O.invert(R).concat(F/O.k),W.invert(R).concat(F/W.k));return function(X){if(X===1)X=W;else{var j=q(X),Z=F/j[2];X=new wt(Z,R[0]-j[0]*Z,R[1]-j[1]*Z)}H.zoom(null,X)}})}function v(x,M,S){return!S&&x.__zooming||new C(x,M)}function C(x,M){this.that=x,this.args=M,this.active=0,this.sourceEvent=null,this.extent=t.apply(x,M),this.taps=0}C.prototype={event:function(x){return x&&(this.sourceEvent=x),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(x,M){return this.mouse&&x!=="mouse"&&(this.mouse[1]=M.invert(this.mouse[0])),this.touch0&&x!=="touch"&&(this.touch0[1]=M.invert(this.touch0[0])),this.touch1&&x!=="touch"&&(this.touch1[1]=M.invert(this.touch1[0])),this.that.__zoom=M,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(x){var M=ae(this.that).datum();l.call(x,this.that,new Er(x,{sourceEvent:this.sourceEvent,target:p,transform:this.that.__zoom,dispatch:l}),M)}};function $(x,...M){if(!e.apply(this,arguments))return;var S=v(this,M).event(x),P=this.__zoom,I=Math.max(r[0],Math.min(r[1],P.k*Math.pow(2,o.apply(this,arguments)))),_=ce(x);if(S.wheel)(S.mouse[0][0]!==_[0]||S.mouse[0][1]!==_[1])&&(S.mouse[1]=P.invert(S.mouse[0]=_)),clearTimeout(S.wheel);else{if(P.k===I)return;S.mouse=[_,P.invert(_)],bt(this),S.start()}Re(x),S.wheel=setTimeout(H,g),S.zoom("mouse",n(d(E(P,I),S.mouse[0],S.mouse[1]),S.extent,i));function H(){S.wheel=null,S.end()}}function z(x,...M){if(c||!e.apply(this,arguments))return;var S=x.currentTarget,P=v(this,M,!0).event(x),I=ae(x.view).on("mousemove.zoom",R,!0).on("mouseup.zoom",F,!0),_=ce(x,S),H=x.clientX,V=x.clientY;Wn(x.view),St(x),P.mouse=[_,this.__zoom.invert(_)],bt(this),P.start();function R(O){if(Re(O),!P.moved){var W=O.clientX-H,q=O.clientY-V;P.moved=W*W+q*q>b}P.event(O).zoom("mouse",n(d(P.that.__zoom,P.mouse[0]=ce(O,S),P.mouse[1]),P.extent,i))}function F(O){I.on("mousemove.zoom mouseup.zoom",null),Gn(O.view,P.moved),Re(O),P.event(O).end()}}function B(x,...M){if(e.apply(this,arguments)){var S=this.__zoom,P=ce(x.changedTouches?x.changedTouches[0]:x,this),I=S.invert(P),_=S.k*(x.shiftKey?.5:2),H=n(d(E(S,_),P,I),t.apply(this,M),i);Re(x),a>0?ae(this).transition().duration(a).call(N,H,P,x):ae(this).call(p.transform,H,P,x)}}function k(x,...M){if(e.apply(this,arguments)){var S=x.touches,P=S.length,I=v(this,M,x.changedTouches.length===P).event(x),_,H,V,R;for(St(x),H=0;H<P;++H)V=S[H],R=ce(V,this),R=[R,this.__zoom.invert(R),V.identifier],I.touch0?!I.touch1&&I.touch0[2]!==R[2]&&(I.touch1=R,I.taps=0):(I.touch0=R,_=!0,I.taps=1+!!h);h&&(h=clearTimeout(h)),_&&(I.taps<2&&(u=R[0],h=setTimeout(function(){h=null},y)),bt(this),I.start())}}function A(x,...M){if(this.__zooming){var S=v(this,M).event(x),P=x.changedTouches,I=P.length,_,H,V,R;for(Re(x),_=0;_<I;++_)H=P[_],V=ce(H,this),S.touch0&&S.touch0[2]===H.identifier?S.touch0[0]=V:S.touch1&&S.touch1[2]===H.identifier&&(S.touch1[0]=V);if(H=S.that.__zoom,S.touch1){var F=S.touch0[0],O=S.touch0[1],W=S.touch1[0],q=S.touch1[1],X=(X=W[0]-F[0])*X+(X=W[1]-F[1])*X,j=(j=q[0]-O[0])*j+(j=q[1]-O[1])*j;H=E(H,Math.sqrt(X/j)),V=[(F[0]+W[0])/2,(F[1]+W[1])/2],R=[(O[0]+q[0])/2,(O[1]+q[1])/2]}else if(S.touch0)V=S.touch0[0],R=S.touch0[1];else return;S.zoom("touch",n(d(H,V,R),S.extent,i))}}function L(x,...M){if(this.__zooming){var S=v(this,M).event(x),P=x.changedTouches,I=P.length,_,H;for(St(x),c&&clearTimeout(c),c=setTimeout(function(){c=null},y),_=0;_<I;++_)H=P[_],S.touch0&&S.touch0[2]===H.identifier?delete S.touch0:S.touch1&&S.touch1[2]===H.identifier&&delete S.touch1;if(S.touch1&&!S.touch0&&(S.touch0=S.touch1,delete S.touch1),S.touch0)S.touch0[1]=this.__zoom.invert(S.touch0[0]);else if(S.end(),S.taps===2&&(H=ce(H,this),Math.hypot(u[0]-H[0],u[1]-H[1])<w)){var V=ae(this).on("dblclick.zoom");V&&V.apply(this,arguments)}}}return p.wheelDelta=function(x){return arguments.length?(o=typeof x=="function"?x:Qe(+x),p):o},p.filter=function(x){return arguments.length?(e=typeof x=="function"?x:Qe(!!x),p):e},p.touchable=function(x){return arguments.length?(s=typeof x=="function"?x:Qe(!!x),p):s},p.extent=function(x){return arguments.length?(t=typeof x=="function"?x:Qe([[+x[0][0],+x[0][1]],[+x[1][0],+x[1][1]]]),p):t},p.scaleExtent=function(x){return arguments.length?(r[0]=+x[0],r[1]=+x[1],p):[r[0],r[1]]},p.translateExtent=function(x){return arguments.length?(i[0][0]=+x[0][0],i[1][0]=+x[1][0],i[0][1]=+x[0][1],i[1][1]=+x[1][1],p):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},p.constrain=function(x){return arguments.length?(n=x,p):n},p.duration=function(x){return arguments.length?(a=+x,p):a},p.interpolate=function(x){return arguments.length?(f=x,p):f},p.on=function(){var x=l.on.apply(l,arguments);return x===l?p:x},p.clickDistance=function(x){return arguments.length?(b=(x=+x)*x,p):Math.sqrt(b)},p.tapDistance=function(x){return arguments.length?(w=+x,p):w},p}function re(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)(o=re(e[n]))!==""&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}const de={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:o})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:o}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},je=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Un=["Enter"," ","Escape"],Qn={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var De;(function(e){e.Strict="strict",e.Loose="loose"})(De||(De={}));var Ee;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Ee||(Ee={}));var Oe;(function(e){e.Partial="partial",e.Full="full"})(Oe||(Oe={}));const Jn={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var ye;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(ye||(ye={}));var st;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(st||(st={}));var Y;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(Y||(Y={}));const rn={[Y.Left]:Y.Right,[Y.Right]:Y.Left,[Y.Top]:Y.Bottom,[Y.Bottom]:Y.Top};function eo(e){return e===null?null:e?"valid":"invalid"}const to=e=>"id"in e&&"source"in e&&"target"in e,Ir=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Lt=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),Xe=(e,t=[0,0])=>{const{width:n,height:o}=he(e),s=e.origin??t,r=n*s[0],i=o*s[1];return{x:e.position.x-r,y:e.position.y-i}},Pr=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((o,s)=>{const r=typeof s=="string";let i=!t.nodeLookup&&!r?s:void 0;t.nodeLookup&&(i=r?t.nodeLookup.get(s):Lt(s)?s:t.nodeLookup.get(s.id));const a=i?rt(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return lt(o,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return ut(n)},We=(e,t={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},o=!1;return e.forEach(s=>{(t.filter===void 0||t.filter(s))&&(n=lt(n,rt(s)),o=!0)}),o?ut(n):{x:0,y:0,width:0,height:0}},Rt=(e,t,[n,o,s]=[0,0,1],r=!1,i=!1)=>{const a={...Ke(t,[n,o,s]),width:t.width/s,height:t.height/s},f=[];for(const l of e.values()){const{measured:h,selectable:u=!0,hidden:c=!1}=l;if(i&&!u||c)continue;const y=h.width??l.width??l.initialWidth??null,g=h.height??l.height??l.initialHeight??null,b=Fe(a,ze(l)),w=(y??0)*(g??0),p=r&&b>0;(!l.internals.handleBounds||p||b>=w||l.dragging)&&f.push(l)}return f},kr=(e,t)=>{const n=new Set;return e.forEach(o=>{n.add(o.id)}),t.filter(o=>n.has(o.source)||n.has(o.target))};function Dr(e,t){const n=new Map,o=t?.nodes?new Set(t.nodes.map(s=>s.id)):null;return e.forEach(s=>{s.measured.width&&s.measured.height&&(t?.includeHiddenNodes||!s.hidden)&&(!o||o.has(s.id))&&n.set(s.id,s)}),n}async function _r({nodes:e,width:t,height:n,panZoom:o,minZoom:s,maxZoom:r},i){if(e.size===0)return Promise.resolve(!0);const a=Dr(e,i),f=We(a),l=Vt(f,t,n,i?.minZoom??s,i?.maxZoom??r,i?.padding??.1);return await o.setViewport(l,{duration:i?.duration,ease:i?.ease,interpolate:i?.interpolate}),Promise.resolve(!0)}function no({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:o=[0,0],nodeExtent:s,onError:r}){const i=n.get(e),a=i.parentId?n.get(i.parentId):void 0,{x:f,y:l}=a?a.internals.positionAbsolute:{x:0,y:0},h=i.origin??o;let u=i.extent||s;if(i.extent==="parent"&&!i.expandParent)if(!a)r?.("005",de.error005());else{const y=a.measured.width,g=a.measured.height;y&&g&&(u=[[f,l],[f+y,l+g]])}else a&&$e(i.extent)&&(u=[[i.extent[0][0]+f,i.extent[0][1]+l],[i.extent[1][0]+f,i.extent[1][1]+l]]);const c=$e(u)?ve(t,u,i.measured):t;return(i.measured.width===void 0||i.measured.height===void 0)&&r?.("015",de.error015()),{position:{x:c.x-f+(i.measured.width??0)*h[0],y:c.y-l+(i.measured.height??0)*h[1]},positionAbsolute:c}}async function zr({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:o,onBeforeDelete:s}){const r=new Set(e.map(c=>c.id)),i=[];for(const c of n){if(c.deletable===!1)continue;const y=r.has(c.id),g=!y&&c.parentId&&i.find(b=>b.id===c.parentId);(y||g)&&i.push(c)}const a=new Set(t.map(c=>c.id)),f=o.filter(c=>c.deletable!==!1),h=kr(i,f);for(const c of f)a.has(c.id)&&!h.find(g=>g.id===c.id)&&h.push(c);if(!s)return{edges:h,nodes:i};const u=await s({nodes:i,edges:h});return typeof u=="boolean"?u?{edges:h,nodes:i}:{edges:[],nodes:[]}:u}const _e=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),ve=(e={x:0,y:0},t,n)=>({x:_e(e.x,t[0][0],t[1][0]-(n?.width??0)),y:_e(e.y,t[0][1],t[1][1]-(n?.height??0))});function oo(e,t,n){const{width:o,height:s}=he(n),{x:r,y:i}=n.internals.positionAbsolute;return ve(e,[[r,i],[r+o,i+s]],t)}const an=(e,t,n)=>e<t?_e(Math.abs(e-t),1,t)/t:e>n?-_e(Math.abs(e-n),1,t)/t:0,so=(e,t,n=15,o=40)=>{const s=an(e.x,o,t.width-o)*n,r=an(e.y,o,t.height-o)*n;return[s,r]},lt=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Dt=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),ut=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),ze=(e,t=[0,0])=>{const{x:n,y:o}=Lt(e)?e.internals.positionAbsolute:Xe(e,t);return{x:n,y:o,width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}},rt=(e,t=[0,0])=>{const{x:n,y:o}=Lt(e)?e.internals.positionAbsolute:Xe(e,t);return{x:n,y:o,x2:n+(e.measured?.width??e.width??e.initialWidth??0),y2:o+(e.measured?.height??e.height??e.initialHeight??0)}},ro=(e,t)=>ut(lt(Dt(e),Dt(t))),Fe=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},cn=e=>le(e.width)&&le(e.height)&&le(e.x)&&le(e.y),le=e=>!isNaN(e)&&isFinite(e),$r=(e,t)=>{},Ge=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),Ke=({x:e,y:t},[n,o,s],r=!1,i=[1,1])=>{const a={x:(e-n)/s,y:(t-o)/s};return r?Ge(a,i):a},it=({x:e,y:t},[n,o,s])=>({x:e*s+n,y:t*s+o});function Me(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function Ar(e,t,n){if(typeof e=="string"||typeof e=="number"){const o=Me(e,n),s=Me(e,t);return{top:o,right:s,bottom:o,left:s,x:s*2,y:o*2}}if(typeof e=="object"){const o=Me(e.top??e.y??0,n),s=Me(e.bottom??e.y??0,n),r=Me(e.left??e.x??0,t),i=Me(e.right??e.x??0,t);return{top:o,right:i,bottom:s,left:r,x:r+i,y:o+s}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function Tr(e,t,n,o,s,r){const{x:i,y:a}=it(e,[t,n,o]),{x:f,y:l}=it({x:e.x+e.width,y:e.y+e.height},[t,n,o]),h=s-f,u=r-l;return{left:Math.floor(i),top:Math.floor(a),right:Math.floor(h),bottom:Math.floor(u)}}const Vt=(e,t,n,o,s,r)=>{const i=Ar(r,t,n),a=(t-i.x)/e.width,f=(n-i.y)/e.height,l=Math.min(a,f),h=_e(l,o,s),u=e.x+e.width/2,c=e.y+e.height/2,y=t/2-u*h,g=n/2-c*h,b=Tr(e,y,g,h,t,n),w={left:Math.min(b.left-i.left,0),top:Math.min(b.top-i.top,0),right:Math.min(b.right-i.right,0),bottom:Math.min(b.bottom-i.bottom,0)};return{x:y-w.left+w.right,y:g-w.top+w.bottom,zoom:h}},Ze=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function $e(e){return e!=null&&e!=="parent"}function he(e){return{width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}}function io(e){return(e.measured?.width??e.width??e.initialWidth)!==void 0&&(e.measured?.height??e.height??e.initialHeight)!==void 0}function ao(e,t={width:0,height:0},n,o,s){const r={...e},i=o.get(n);if(i){const a=i.origin||s;r.x+=i.internals.positionAbsolute.x-(t.width??0)*a[0],r.y+=i.internals.positionAbsolute.y-(t.height??0)*a[1]}return r}function ln(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Hr(){let e,t;return{promise:new Promise((o,s)=>{e=o,t=s}),resolve:e,reject:t}}function Lr(e){return{...Qn,...e||{}}}function Ve(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:o,containerBounds:s}){const{x:r,y:i}=ue(e),a=Ke({x:r-(s?.left??0),y:i-(s?.top??0)},o),{x:f,y:l}=n?Ge(a,t):a;return{xSnapped:f,ySnapped:l,...a}}const Bt=e=>({width:e.offsetWidth,height:e.offsetHeight}),co=e=>e?.getRootNode?.()||window?.document,Rr=["INPUT","SELECT","TEXTAREA"];function lo(e){const t=e.composedPath?.()?.[0]||e.target;return t?.nodeType!==1?!1:Rr.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const uo=e=>"clientX"in e,ue=(e,t)=>{const n=uo(e),o=n?e.clientX:e.touches?.[0].clientX,s=n?e.clientY:e.touches?.[0].clientY;return{x:o-(t?.left??0),y:s-(t?.top??0)}},un=(e,t,n,o,s)=>{const r=t.querySelectorAll(`.${e}`);return!r||!r.length?null:Array.from(r).map(i=>{const a=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:s,position:i.getAttribute("data-handlepos"),x:(a.left-n.left)/o,y:(a.top-n.top)/o,...Bt(i)}})};function fo({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:s,sourceControlY:r,targetControlX:i,targetControlY:a}){const f=e*.125+s*.375+i*.375+n*.125,l=t*.125+r*.375+a*.375+o*.125,h=Math.abs(f-e),u=Math.abs(l-t);return[f,l,h,u]}function Je(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function dn({pos:e,x1:t,y1:n,x2:o,y2:s,c:r}){switch(e){case Y.Left:return[t-Je(t-o,r),n];case Y.Right:return[t+Je(o-t,r),n];case Y.Top:return[t,n-Je(n-s,r)];case Y.Bottom:return[t,n+Je(s-n,r)]}}function ho({sourceX:e,sourceY:t,sourcePosition:n=Y.Bottom,targetX:o,targetY:s,targetPosition:r=Y.Top,curvature:i=.25}){const[a,f]=dn({pos:n,x1:e,y1:t,x2:o,y2:s,c:i}),[l,h]=dn({pos:r,x1:o,y1:s,x2:e,y2:t,c:i}),[u,c,y,g]=fo({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:a,sourceControlY:f,targetControlX:l,targetControlY:h});return[`M${e},${t} C${a},${f} ${l},${h} ${o},${s}`,u,c,y,g]}function go({sourceX:e,sourceY:t,targetX:n,targetY:o}){const s=Math.abs(n-e)/2,r=n<e?n+s:n-s,i=Math.abs(o-t)/2,a=o<t?o+i:o-i;return[r,a,s,i]}function Vr({sourceNode:e,targetNode:t,selected:n=!1,zIndex:o=0,elevateOnSelect:s=!1,zIndexMode:r="basic"}){if(r==="manual")return o;const i=s&&n?o+1e3:o,a=Math.max(e.parentId||s&&e.selected?e.internals.z:0,t.parentId||s&&t.selected?t.internals.z:0);return i+a}function Br({sourceNode:e,targetNode:t,width:n,height:o,transform:s}){const r=lt(rt(e),rt(t));r.x===r.x2&&(r.x2+=1),r.y===r.y2&&(r.y2+=1);const i={x:-s[0]/s[2],y:-s[1]/s[2],width:n/s[2],height:o/s[2]};return Fe(i,ut(r))>0}const jr=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`xy-edge__${e}${t||""}-${n}${o||""}`,Or=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Fr=(e,t,n={})=>{if(!e.source||!e.target)return t;const o=n.getEdgeId||jr;let s;return to(e)?s={...e}:s={...e,id:o(e)},Or(s,t)?t:(s.sourceHandle===null&&delete s.sourceHandle,s.targetHandle===null&&delete s.targetHandle,t.concat(s))};function po({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[s,r,i,a]=go({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,s,r,i,a]}const fn={[Y.Left]:{x:-1,y:0},[Y.Right]:{x:1,y:0},[Y.Top]:{x:0,y:-1},[Y.Bottom]:{x:0,y:1}},Zr=({source:e,sourcePosition:t=Y.Bottom,target:n})=>t===Y.Left||t===Y.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},hn=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Yr({source:e,sourcePosition:t=Y.Bottom,target:n,targetPosition:o=Y.Top,center:s,offset:r,stepPosition:i}){const a=fn[t],f=fn[o],l={x:e.x+a.x*r,y:e.y+a.y*r},h={x:n.x+f.x*r,y:n.y+f.y*r},u=Zr({source:l,sourcePosition:t,target:h}),c=u.x!==0?"x":"y",y=u[c];let g=[],b,w;const p={x:0,y:0},E={x:0,y:0},[,,d,m]=go({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(a[c]*f[c]===-1){c==="x"?(b=s.x??l.x+(h.x-l.x)*i,w=s.y??(l.y+h.y)/2):(b=s.x??(l.x+h.x)/2,w=s.y??l.y+(h.y-l.y)*i);const v=[{x:b,y:l.y},{x:b,y:h.y}],C=[{x:l.x,y:w},{x:h.x,y:w}];a[c]===y?g=c==="x"?v:C:g=c==="x"?C:v}else{const v=[{x:l.x,y:h.y}],C=[{x:h.x,y:l.y}];if(c==="x"?g=a.x===y?C:v:g=a.y===y?v:C,t===o){const A=Math.abs(e[c]-n[c]);if(A<=r){const L=Math.min(r-1,r-A);a[c]===y?p[c]=(l[c]>e[c]?-1:1)*L:E[c]=(h[c]>n[c]?-1:1)*L}}if(t!==o){const A=c==="x"?"y":"x",L=a[c]===f[A],x=l[A]>h[A],M=l[A]<h[A];(a[c]===1&&(!L&&x||L&&M)||a[c]!==1&&(!L&&M||L&&x))&&(g=c==="x"?v:C)}const $={x:l.x+p.x,y:l.y+p.y},z={x:h.x+E.x,y:h.y+E.y},B=Math.max(Math.abs($.x-g[0].x),Math.abs(z.x-g[0].x)),k=Math.max(Math.abs($.y-g[0].y),Math.abs(z.y-g[0].y));B>=k?(b=($.x+z.x)/2,w=g[0].y):(b=g[0].x,w=($.y+z.y)/2)}return[[e,{x:l.x+p.x,y:l.y+p.y},...g,{x:h.x+E.x,y:h.y+E.y},n],b,w,d,m]}function Xr(e,t,n,o){const s=Math.min(hn(e,t)/2,hn(t,n)/2,o),{x:r,y:i}=t;if(e.x===r&&r===n.x||e.y===i&&i===n.y)return`L${r} ${i}`;if(e.y===i){const l=e.x<n.x?-1:1,h=e.y<n.y?1:-1;return`L ${r+s*l},${i}Q ${r},${i} ${r},${i+s*h}`}const a=e.x<n.x?1:-1,f=e.y<n.y?-1:1;return`L ${r},${i+s*f}Q ${r},${i} ${r+s*a},${i}`}function _t({sourceX:e,sourceY:t,sourcePosition:n=Y.Bottom,targetX:o,targetY:s,targetPosition:r=Y.Top,borderRadius:i=5,centerX:a,centerY:f,offset:l=20,stepPosition:h=.5}){const[u,c,y,g,b]=Yr({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:s},targetPosition:r,center:{x:a,y:f},offset:l,stepPosition:h});return[u.reduce((p,E,d)=>{let m="";return d>0&&d<u.length-1?m=Xr(u[d-1],E,u[d+1],i):m=`${d===0?"M":"L"}${E.x} ${E.y}`,p+=m,p},""),c,y,g,b]}function gn(e){return e&&!!(e.internals.handleBounds||e.handles?.length)&&!!(e.measured.width||e.width||e.initialWidth)}function Wr(e){const{sourceNode:t,targetNode:n}=e;if(!gn(t)||!gn(n))return null;const o=t.internals.handleBounds||pn(t.handles),s=n.internals.handleBounds||pn(n.handles),r=mn(o?.source??[],e.sourceHandle),i=mn(e.connectionMode===De.Strict?s?.target??[]:(s?.target??[]).concat(s?.source??[]),e.targetHandle);if(!r||!i)return e.onError?.("008",de.error008(r?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const a=r?.position||Y.Bottom,f=i?.position||Y.Top,l=Se(t,r,a),h=Se(n,i,f);return{sourceX:l.x,sourceY:l.y,targetX:h.x,targetY:h.y,sourcePosition:a,targetPosition:f}}function pn(e){if(!e)return null;const t=[],n=[];for(const o of e)o.width=o.width??1,o.height=o.height??1,o.type==="source"?t.push(o):o.type==="target"&&n.push(o);return{source:t,target:n}}function Se(e,t,n=Y.Left,o=!1){const s=(t?.x??0)+e.internals.positionAbsolute.x,r=(t?.y??0)+e.internals.positionAbsolute.y,{width:i,height:a}=t??he(e);if(o)return{x:s+i/2,y:r+a/2};switch(t?.position??n){case Y.Top:return{x:s+i/2,y:r};case Y.Right:return{x:s+i,y:r+a/2};case Y.Bottom:return{x:s+i/2,y:r+a};case Y.Left:return{x:s,y:r+a/2}}}function mn(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function zt(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`:""}function Gr(e,{id:t,defaultColor:n,defaultMarkerStart:o,defaultMarkerEnd:s}){const r=new Set;return e.reduce((i,a)=>([a.markerStart||o,a.markerEnd||s].forEach(f=>{if(f&&typeof f=="object"){const l=zt(f,t);r.has(l)||(i.push({id:l,color:f.color||n,...f}),r.add(l))}}),i),[]).sort((i,a)=>i.id.localeCompare(a.id))}const mo=1e3,Kr=10,jt={nodeOrigin:[0,0],nodeExtent:je,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},qr={...jt,checkEquality:!0};function Ot(e,t){const n={...e};for(const o in t)t[o]!==void 0&&(n[o]=t[o]);return n}function Ur(e,t,n){const o=Ot(jt,n);for(const s of e.values())if(s.parentId)Zt(s,e,t,o);else{const r=Xe(s,o.nodeOrigin),i=$e(s.extent)?s.extent:o.nodeExtent,a=ve(r,i,he(s));s.internals.positionAbsolute=a}}function Qr(e,t){if(!e.handles)return e.measured?t?.internals.handleBounds:void 0;const n=[],o=[];for(const s of e.handles){const r={id:s.id,width:s.width??1,height:s.height??1,nodeId:e.id,x:s.x,y:s.y,position:s.position,type:s.type};s.type==="source"?n.push(r):s.type==="target"&&o.push(r)}return{source:n,target:o}}function Ft(e){return e==="manual"}function $t(e,t,n,o={}){const s=Ot(qr,o),r={i:0},i=new Map(t),a=s?.elevateNodesOnSelect&&!Ft(s.zIndexMode)?mo:0;let f=e.length>0;t.clear(),n.clear();for(const l of e){let h=i.get(l.id);if(s.checkEquality&&l===h?.internals.userNode)t.set(l.id,h);else{const u=Xe(l,s.nodeOrigin),c=$e(l.extent)?l.extent:s.nodeExtent,y=ve(u,c,he(l));h={...s.defaults,...l,measured:{width:l.measured?.width,height:l.measured?.height},internals:{positionAbsolute:y,handleBounds:Qr(l,h),z:yo(l,a,s.zIndexMode),userNode:l}},t.set(l.id,h)}(h.measured===void 0||h.measured.width===void 0||h.measured.height===void 0)&&!h.hidden&&(f=!1),l.parentId&&Zt(h,t,n,o,r)}return f}function Jr(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function Zt(e,t,n,o,s){const{elevateNodesOnSelect:r,nodeOrigin:i,nodeExtent:a,zIndexMode:f}=Ot(jt,o),l=e.parentId,h=t.get(l);if(!h){console.warn(`Parent node ${l} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}Jr(e,n),s&&!h.parentId&&h.internals.rootParentIndex===void 0&&f==="auto"&&(h.internals.rootParentIndex=++s.i,h.internals.z=h.internals.z+s.i*Kr),s&&h.internals.rootParentIndex!==void 0&&(s.i=h.internals.rootParentIndex);const u=r&&!Ft(f)?mo:0,{x:c,y,z:g}=ei(e,h,i,a,u,f),{positionAbsolute:b}=e.internals,w=c!==b.x||y!==b.y;(w||g!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:w?{x:c,y}:b,z:g}})}function yo(e,t,n){const o=le(e.zIndex)?e.zIndex:0;return Ft(n)?o:o+(e.selected?t:0)}function ei(e,t,n,o,s,r){const{x:i,y:a}=t.internals.positionAbsolute,f=he(e),l=Xe(e,n),h=$e(e.extent)?ve(l,e.extent,f):l;let u=ve({x:i+h.x,y:a+h.y},o,f);e.extent==="parent"&&(u=oo(u,f,t));const c=yo(e,s,r),y=t.internals.z??0;return{x:u.x,y:u.y,z:y>=c?y+1:c}}function Yt(e,t,n,o=[0,0]){const s=[],r=new Map;for(const i of e){const a=t.get(i.parentId);if(!a)continue;const f=r.get(i.parentId)?.expandedRect??ze(a),l=ro(f,i.rect);r.set(i.parentId,{expandedRect:l,parent:a})}return r.size>0&&r.forEach(({expandedRect:i,parent:a},f)=>{const l=a.internals.positionAbsolute,h=he(a),u=a.origin??o,c=i.x<l.x?Math.round(Math.abs(l.x-i.x)):0,y=i.y<l.y?Math.round(Math.abs(l.y-i.y)):0,g=Math.max(h.width,Math.round(i.width)),b=Math.max(h.height,Math.round(i.height)),w=(g-h.width)*u[0],p=(b-h.height)*u[1];(c>0||y>0||w||p)&&(s.push({id:f,type:"position",position:{x:a.position.x-c+w,y:a.position.y-y+p}}),n.get(f)?.forEach(E=>{e.some(d=>d.id===E.id)||s.push({id:E.id,type:"position",position:{x:E.position.x+c,y:E.position.y+y}})})),(h.width<i.width||h.height<i.height||c||y)&&s.push({id:f,type:"dimensions",setAttributes:!0,dimensions:{width:g+(c?u[0]*c-w:0),height:b+(y?u[1]*y-p:0)}})}),s}function ti(e,t,n,o,s,r,i){const a=o?.querySelector(".xyflow__viewport");let f=!1;if(!a)return{changes:[],updatedInternals:f};const l=[],h=window.getComputedStyle(a),{m22:u}=new window.DOMMatrixReadOnly(h.transform),c=[];for(const y of e.values()){const g=t.get(y.id);if(!g)continue;if(g.hidden){t.set(g.id,{...g,internals:{...g.internals,handleBounds:void 0}}),f=!0;continue}const b=Bt(y.nodeElement),w=g.measured.width!==b.width||g.measured.height!==b.height;if(!!(b.width&&b.height&&(w||!g.internals.handleBounds||y.force))){const E=y.nodeElement.getBoundingClientRect(),d=$e(g.extent)?g.extent:r;let{positionAbsolute:m}=g.internals;g.parentId&&g.extent==="parent"?m=oo(m,b,t.get(g.parentId)):d&&(m=ve(m,d,b));const N={...g,measured:b,internals:{...g.internals,positionAbsolute:m,handleBounds:{source:un("source",y.nodeElement,E,u,g.id),target:un("target",y.nodeElement,E,u,g.id)}}};t.set(g.id,N),g.parentId&&Zt(N,t,n,{nodeOrigin:s,zIndexMode:i}),f=!0,w&&(l.push({id:g.id,type:"dimensions",dimensions:b}),g.expandParent&&g.parentId&&c.push({id:g.id,parentId:g.parentId,rect:ze(N,s)}))}}if(c.length>0){const y=Yt(c,t,n,s);l.push(...y)}return{changes:l,updatedInternals:f}}async function ni({delta:e,panZoom:t,transform:n,translateExtent:o,width:s,height:r}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[s,r]],o),a=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(a)}function yn(e,t,n,o,s,r){let i=s;const a=o.get(i)||new Map;o.set(i,a.set(n,t)),i=`${s}-${e}`;const f=o.get(i)||new Map;if(o.set(i,f.set(n,t)),r){i=`${s}-${e}-${r}`;const l=o.get(i)||new Map;o.set(i,l.set(n,t))}}function xo(e,t,n){e.clear(),t.clear();for(const o of n){const{source:s,target:r,sourceHandle:i=null,targetHandle:a=null}=o,f={edgeId:o.id,source:s,target:r,sourceHandle:i,targetHandle:a},l=`${s}-${i}--${r}-${a}`,h=`${r}-${a}--${s}-${i}`;yn("source",f,h,e,s,i),yn("target",f,l,e,r,a),t.set(o.id,o)}}function wo(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:wo(n,t):!1}function xn(e,t,n){let o=e;do{if(o?.matches?.(t))return!0;if(o===n)return!1;o=o?.parentElement}while(o);return!1}function oi(e,t,n,o){const s=new Map;for(const[r,i]of e)if((i.selected||i.id===o)&&(!i.parentId||!wo(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const a=e.get(r);a&&s.set(r,{id:r,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return s}function Nt({nodeId:e,dragItems:t,nodeLookup:n,dragging:o=!0}){const s=[];for(const[i,a]of t){const f=n.get(i)?.internals.userNode;f&&s.push({...f,position:a.position,dragging:o})}if(!e)return[s[0],s];const r=n.get(e)?.internals.userNode;return[r?{...r,position:t.get(e)?.position||r.position,dragging:o}:s[0],s]}function si({dragItems:e,snapGrid:t,x:n,y:o}){const s=e.values().next().value;if(!s)return null;const r={x:n-s.distance.x,y:o-s.distance.y},i=Ge(r,t);return{x:i.x-r.x,y:i.y-r.y}}function ri({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:o,onDragStop:s}){let r={x:null,y:null},i=0,a=new Map,f=!1,l={x:0,y:0},h=null,u=!1,c=null,y=!1,g=!1,b=null;function w({noDragClassName:E,handleSelector:d,domNode:m,isSelectable:N,nodeId:v,nodeClickDistance:C=0}){c=ae(m);function $({x:A,y:L}){const{nodeLookup:x,nodeExtent:M,snapGrid:S,snapToGrid:P,nodeOrigin:I,onNodeDrag:_,onSelectionDrag:H,onError:V,updateNodePositions:R}=t();r={x:A,y:L};let F=!1;const O=a.size>1,W=O&&M?Dt(We(a)):null,q=O&&P?si({dragItems:a,snapGrid:S,x:A,y:L}):null;for(const[X,j]of a){if(!x.has(X))continue;let Z={x:A-j.distance.x,y:L-j.distance.y};P&&(Z=q?{x:Math.round(Z.x+q.x),y:Math.round(Z.y+q.y)}:Ge(Z,S));let Q=null;if(O&&M&&!j.extent&&W){const{positionAbsolute:K}=j.internals,ee=K.x-W.x+M[0][0],ne=K.x+j.measured.width-W.x2+M[1][0],te=K.y-W.y+M[0][1],ie=K.y+j.measured.height-W.y2+M[1][1];Q=[[ee,te],[ne,ie]]}const{position:U,positionAbsolute:G}=no({nodeId:X,nextPosition:Z,nodeLookup:x,nodeExtent:Q||M,nodeOrigin:I,onError:V});F=F||j.position.x!==U.x||j.position.y!==U.y,j.position=U,j.internals.positionAbsolute=G}if(g=g||F,!!F&&(R(a,!0),b&&(o||_||!v&&H))){const[X,j]=Nt({nodeId:v,dragItems:a,nodeLookup:x});o?.(b,a,X,j),_?.(b,X,j),v||H?.(b,j)}}async function z(){if(!h)return;const{transform:A,panBy:L,autoPanSpeed:x,autoPanOnNodeDrag:M}=t();if(!M){f=!1,cancelAnimationFrame(i);return}const[S,P]=so(l,h,x);(S!==0||P!==0)&&(r.x=(r.x??0)-S/A[2],r.y=(r.y??0)-P/A[2],await L({x:S,y:P})&&$(r)),i=requestAnimationFrame(z)}function B(A){const{nodeLookup:L,multiSelectionActive:x,nodesDraggable:M,transform:S,snapGrid:P,snapToGrid:I,selectNodesOnDrag:_,onNodeDragStart:H,onSelectionDragStart:V,unselectNodesAndEdges:R}=t();u=!0,(!_||!N)&&!x&&v&&(L.get(v)?.selected||R()),N&&_&&v&&e?.(v);const F=Ve(A.sourceEvent,{transform:S,snapGrid:P,snapToGrid:I,containerBounds:h});if(r=F,a=oi(L,M,F,v),a.size>0&&(n||H||!v&&V)){const[O,W]=Nt({nodeId:v,dragItems:a,nodeLookup:L});n?.(A.sourceEvent,a,O,W),H?.(A.sourceEvent,O,W),v||V?.(A.sourceEvent,W)}}const k=Kn().clickDistance(C).on("start",A=>{const{domNode:L,nodeDragThreshold:x,transform:M,snapGrid:S,snapToGrid:P}=t();h=L?.getBoundingClientRect()||null,y=!1,g=!1,b=A.sourceEvent,x===0&&B(A),r=Ve(A.sourceEvent,{transform:M,snapGrid:S,snapToGrid:P,containerBounds:h}),l=ue(A.sourceEvent,h)}).on("drag",A=>{const{autoPanOnNodeDrag:L,transform:x,snapGrid:M,snapToGrid:S,nodeDragThreshold:P,nodeLookup:I}=t(),_=Ve(A.sourceEvent,{transform:x,snapGrid:M,snapToGrid:S,containerBounds:h});if(b=A.sourceEvent,(A.sourceEvent.type==="touchmove"&&A.sourceEvent.touches.length>1||v&&!I.has(v))&&(y=!0),!y){if(!f&&L&&u&&(f=!0,z()),!u){const H=ue(A.sourceEvent,h),V=H.x-l.x,R=H.y-l.y;Math.sqrt(V*V+R*R)>P&&B(A)}(r.x!==_.xSnapped||r.y!==_.ySnapped)&&a&&u&&(l=ue(A.sourceEvent,h),$(_))}}).on("end",A=>{if(!(!u||y)&&(f=!1,u=!1,cancelAnimationFrame(i),a.size>0)){const{nodeLookup:L,updateNodePositions:x,onNodeDragStop:M,onSelectionDragStop:S}=t();if(g&&(x(a,!1),g=!1),s||M||!v&&S){const[P,I]=Nt({nodeId:v,dragItems:a,nodeLookup:L,dragging:!1});s?.(A.sourceEvent,a,P,I),M?.(A.sourceEvent,P,I),v||S?.(A.sourceEvent,I)}}}).filter(A=>{const L=A.target;return!A.button&&(!E||!xn(L,`.${E}`,m))&&(!d||xn(L,d,m))});c.call(k)}function p(){c?.on(".drag",null)}return{update:w,destroy:p}}function ii(e,t,n){const o=[],s={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const r of t.values())Fe(s,ze(r))>0&&o.push(r);return o}const ai=250;function ci(e,t,n,o){let s=[],r=1/0;const i=ii(e,n,t+ai);for(const a of i){const f=[...a.internals.handleBounds?.source??[],...a.internals.handleBounds?.target??[]];for(const l of f){if(o.nodeId===l.nodeId&&o.type===l.type&&o.id===l.id)continue;const{x:h,y:u}=Se(a,l,l.position,!0),c=Math.sqrt(Math.pow(h-e.x,2)+Math.pow(u-e.y,2));c>t||(c<r?(s=[{...l,x:h,y:u}],r=c):c===r&&s.push({...l,x:h,y:u}))}}if(!s.length)return null;if(s.length>1){const a=o.type==="source"?"target":"source";return s.find(f=>f.type===a)??s[0]}return s[0]}function bo(e,t,n,o,s,r=!1){const i=o.get(e);if(!i)return null;const a=s==="strict"?i.internals.handleBounds?.[t]:[...i.internals.handleBounds?.source??[],...i.internals.handleBounds?.target??[]],f=(n?a?.find(l=>l.id===n):a?.[0])??null;return f&&r?{...f,...Se(i,f,f.position,!0)}:f}function Eo(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function li(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const vo=()=>!0;function ui(e,{connectionMode:t,connectionRadius:n,handleId:o,nodeId:s,edgeUpdaterType:r,isTarget:i,domNode:a,nodeLookup:f,lib:l,autoPanOnConnect:h,flowId:u,panBy:c,cancelConnection:y,onConnectStart:g,onConnect:b,onConnectEnd:w,isValidConnection:p=vo,onReconnectEnd:E,updateConnection:d,getTransform:m,getFromHandle:N,autoPanSpeed:v,dragThreshold:C=1,handleDomNode:$}){const z=co(e.target);let B=0,k;const{x:A,y:L}=ue(e),x=Eo(r,$),M=a?.getBoundingClientRect();let S=!1;if(!M||!x)return;const P=bo(s,x,o,f,t);if(!P)return;let I=ue(e,M),_=!1,H=null,V=!1,R=null;function F(){if(!h||!M)return;const[U,G]=so(I,M,v);c({x:U,y:G}),B=requestAnimationFrame(F)}const O={...P,nodeId:s,type:x,position:P.position},W=f.get(s);let X={inProgress:!0,isValid:null,from:Se(W,O,Y.Left,!0),fromHandle:O,fromPosition:O.position,fromNode:W,to:I,toHandle:null,toPosition:rn[O.position],toNode:null,pointer:I};function j(){S=!0,d(X),g?.(e,{nodeId:s,handleId:o,handleType:x})}C===0&&j();function Z(U){if(!S){const{x:ie,y:ge}=ue(U),fe=ie-A,we=ge-L;if(!(fe*fe+we*we>C*C))return;j()}if(!N()||!O){Q(U);return}const G=m();I=ue(U,M),k=ci(Ke(I,G,!1,[1,1]),n,f,O),_||(F(),_=!0);const K=So(U,{handle:k,connectionMode:t,fromNodeId:s,fromHandleId:o,fromType:i?"target":"source",isValidConnection:p,doc:z,lib:l,flowId:u,nodeLookup:f});R=K.handleDomNode,H=K.connection,V=li(!!k,K.isValid);const ee=f.get(s),ne=ee?Se(ee,O,Y.Left,!0):X.from,te={...X,from:ne,isValid:V,to:K.toHandle&&V?it({x:K.toHandle.x,y:K.toHandle.y},G):I,toHandle:K.toHandle,toPosition:V&&K.toHandle?K.toHandle.position:rn[O.position],toNode:K.toHandle?f.get(K.toHandle.nodeId):null,pointer:I};d(te),X=te}function Q(U){if(!("touches"in U&&U.touches.length>0)){if(S){(k||R)&&H&&V&&b?.(H);const{inProgress:G,...K}=X,ee={...K,toPosition:X.toHandle?X.toPosition:null};w?.(U,ee),r&&E?.(U,ee)}y(),cancelAnimationFrame(B),_=!1,V=!1,H=null,R=null,z.removeEventListener("mousemove",Z),z.removeEventListener("mouseup",Q),z.removeEventListener("touchmove",Z),z.removeEventListener("touchend",Q)}}z.addEventListener("mousemove",Z),z.addEventListener("mouseup",Q),z.addEventListener("touchmove",Z),z.addEventListener("touchend",Q)}function So(e,{handle:t,connectionMode:n,fromNodeId:o,fromHandleId:s,fromType:r,doc:i,lib:a,flowId:f,isValidConnection:l=vo,nodeLookup:h}){const u=r==="target",c=t?i.querySelector(`.${a}-flow__handle[data-id="${f}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:y,y:g}=ue(e),b=i.elementFromPoint(y,g),w=b?.classList.contains(`${a}-flow__handle`)?b:c,p={handleDomNode:w,isValid:!1,connection:null,toHandle:null};if(w){const E=Eo(void 0,w),d=w.getAttribute("data-nodeid"),m=w.getAttribute("data-handleid"),N=w.classList.contains("connectable"),v=w.classList.contains("connectableend");if(!d||!E)return p;const C={source:u?d:o,sourceHandle:u?m:s,target:u?o:d,targetHandle:u?s:m};p.connection=C;const z=N&&v&&(n===De.Strict?u&&E==="source"||!u&&E==="target":d!==o||m!==s);p.isValid=z&&l(C),p.toHandle=bo(d,E,m,h,n,!0)}return p}const At={onPointerDown:ui,isValid:So};function di({domNode:e,panZoom:t,getTransform:n,getViewScale:o}){const s=ae(e);function r({translateExtent:a,width:f,height:l,zoomStep:h=1,pannable:u=!0,zoomable:c=!0,inversePan:y=!1}){const g=d=>{if(d.sourceEvent.type!=="wheel"||!t)return;const m=n(),N=d.sourceEvent.ctrlKey&&Ze()?10:1,v=-d.sourceEvent.deltaY*(d.sourceEvent.deltaMode===1?.05:d.sourceEvent.deltaMode?1:.002)*h,C=m[2]*Math.pow(2,v*N);t.scaleTo(C)};let b=[0,0];const w=d=>{(d.sourceEvent.type==="mousedown"||d.sourceEvent.type==="touchstart")&&(b=[d.sourceEvent.clientX??d.sourceEvent.touches[0].clientX,d.sourceEvent.clientY??d.sourceEvent.touches[0].clientY])},p=d=>{const m=n();if(d.sourceEvent.type!=="mousemove"&&d.sourceEvent.type!=="touchmove"||!t)return;const N=[d.sourceEvent.clientX??d.sourceEvent.touches[0].clientX,d.sourceEvent.clientY??d.sourceEvent.touches[0].clientY],v=[N[0]-b[0],N[1]-b[1]];b=N;const C=o()*Math.max(m[2],Math.log(m[2]))*(y?-1:1),$={x:m[0]-v[0]*C,y:m[1]-v[1]*C},z=[[0,0],[f,l]];t.setViewportConstrained({x:$.x,y:$.y,zoom:m[2]},z,a)},E=qn().on("start",w).on("zoom",u?p:null).on("zoom.wheel",c?g:null);s.call(E,{})}function i(){s.on("zoom",null)}return{update:r,destroy:i,pointer:ce}}const dt=e=>({x:e.x,y:e.y,zoom:e.k}),Ct=({x:e,y:t,zoom:n})=>Ht.translate(e,t).scale(n),Ie=(e,t)=>e.target.closest(`.${t}`),No=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),fi=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,Mt=(e,t=0,n=fi,o=()=>{})=>{const s=typeof t=="number"&&t>0;return s||o(),s?e.transition().duration(t).ease(n).on("end",o):e},Co=e=>{const t=e.ctrlKey&&Ze()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function hi({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:o,panOnScrollMode:s,panOnScrollSpeed:r,zoomOnPinch:i,onPanZoomStart:a,onPanZoom:f,onPanZoomEnd:l}){return h=>{if(Ie(h,t))return h.ctrlKey&&h.preventDefault(),!1;h.preventDefault(),h.stopImmediatePropagation();const u=n.property("__zoom").k||1;if(h.ctrlKey&&i){const w=ce(h),p=Co(h),E=u*Math.pow(2,p);o.scaleTo(n,E,w,h);return}const c=h.deltaMode===1?20:1;let y=s===Ee.Vertical?0:h.deltaX*c,g=s===Ee.Horizontal?0:h.deltaY*c;!Ze()&&h.shiftKey&&s!==Ee.Vertical&&(y=h.deltaY*c,g=0),o.translateBy(n,-(y/u)*r,-(g/u)*r,{internal:!0});const b=dt(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling?(f?.(h,b),e.panScrollTimeout=setTimeout(()=>{l?.(h,b),e.isPanScrolling=!1},150)):(e.isPanScrolling=!0,a?.(h,b))}}function gi({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(o,s){const r=o.type==="wheel",i=!t&&r&&!o.ctrlKey,a=Ie(o,e);if(o.ctrlKey&&r&&a&&o.preventDefault(),i||a)return null;o.preventDefault(),n.call(this,o,s)}}function pi({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return o=>{if(o.sourceEvent?.internal)return;const s=dt(o.transform);e.mouseButton=o.sourceEvent?.button||0,e.isZoomingOrPanning=!0,e.prevViewport=s,o.sourceEvent?.type==="mousedown"&&t(!0),n&&n?.(o.sourceEvent,s)}}function mi({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:o,onPanZoom:s}){return r=>{e.usedRightMouseButton=!!(n&&No(t,e.mouseButton??0)),r.sourceEvent?.sync||o([r.transform.x,r.transform.y,r.transform.k]),s&&!r.sourceEvent?.internal&&s?.(r.sourceEvent,dt(r.transform))}}function yi({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:o,onPanZoomEnd:s,onPaneContextMenu:r}){return i=>{if(!i.sourceEvent?.internal&&(e.isZoomingOrPanning=!1,r&&No(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&r(i.sourceEvent),e.usedRightMouseButton=!1,o(!1),s)){const a=dt(i.transform);e.prevViewport=a,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{s?.(i.sourceEvent,a)},n?150:0)}}}function xi({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:o,panOnScroll:s,zoomOnDoubleClick:r,userSelectionActive:i,noWheelClassName:a,noPanClassName:f,lib:l,connectionInProgress:h}){return u=>{const c=e||t,y=n&&u.ctrlKey,g=u.type==="wheel";if(u.button===1&&u.type==="mousedown"&&(Ie(u,`${l}-flow__node`)||Ie(u,`${l}-flow__edge`)))return!0;if(!o&&!c&&!s&&!r&&!n||i||h&&!g||Ie(u,a)&&g||Ie(u,f)&&(!g||s&&g&&!e)||!n&&u.ctrlKey&&g)return!1;if(!n&&u.type==="touchstart"&&u.touches?.length>1)return u.preventDefault(),!1;if(!c&&!s&&!y&&g||!o&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(o)&&!o.includes(u.button)&&u.type==="mousedown")return!1;const b=Array.isArray(o)&&o.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||g)&&b}}function wi({domNode:e,minZoom:t,maxZoom:n,translateExtent:o,viewport:s,onPanZoom:r,onPanZoomStart:i,onPanZoomEnd:a,onDraggingChange:f}){const l={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},h=e.getBoundingClientRect(),u=qn().scaleExtent([t,n]).translateExtent(o),c=ae(e).call(u);E({x:s.x,y:s.y,zoom:_e(s.zoom,t,n)},[[0,0],[h.width,h.height]],o);const y=c.on("wheel.zoom"),g=c.on("dblclick.zoom");u.wheelDelta(Co);function b(k,A){return c?new Promise(L=>{u?.interpolate(A?.interpolate==="linear"?Et:ot).transform(Mt(c,A?.duration,A?.ease,()=>L(!0)),k)}):Promise.resolve(!1)}function w({noWheelClassName:k,noPanClassName:A,onPaneContextMenu:L,userSelectionActive:x,panOnScroll:M,panOnDrag:S,panOnScrollMode:P,panOnScrollSpeed:I,preventScrolling:_,zoomOnPinch:H,zoomOnScroll:V,zoomOnDoubleClick:R,zoomActivationKeyPressed:F,lib:O,onTransformChange:W,connectionInProgress:q,paneClickDistance:X,selectionOnDrag:j}){x&&!l.isZoomingOrPanning&&p();const Z=M&&!F&&!x;u.clickDistance(j?1/0:!le(X)||X<0?0:X);const Q=Z?hi({zoomPanValues:l,noWheelClassName:k,d3Selection:c,d3Zoom:u,panOnScrollMode:P,panOnScrollSpeed:I,zoomOnPinch:H,onPanZoomStart:i,onPanZoom:r,onPanZoomEnd:a}):gi({noWheelClassName:k,preventScrolling:_,d3ZoomHandler:y});if(c.on("wheel.zoom",Q,{passive:!1}),!x){const G=pi({zoomPanValues:l,onDraggingChange:f,onPanZoomStart:i});u.on("start",G);const K=mi({zoomPanValues:l,panOnDrag:S,onPaneContextMenu:!!L,onPanZoom:r,onTransformChange:W});u.on("zoom",K);const ee=yi({zoomPanValues:l,panOnDrag:S,panOnScroll:M,onPaneContextMenu:L,onPanZoomEnd:a,onDraggingChange:f});u.on("end",ee)}const U=xi({zoomActivationKeyPressed:F,panOnDrag:S,zoomOnScroll:V,panOnScroll:M,zoomOnDoubleClick:R,zoomOnPinch:H,userSelectionActive:x,noPanClassName:A,noWheelClassName:k,lib:O,connectionInProgress:q});u.filter(U),R?c.on("dblclick.zoom",g):c.on("dblclick.zoom",null)}function p(){u.on("zoom",null)}async function E(k,A,L){const x=Ct(k),M=u?.constrain()(x,A,L);return M&&await b(M),new Promise(S=>S(M))}async function d(k,A){const L=Ct(k);return await b(L,A),new Promise(x=>x(L))}function m(k){if(c){const A=Ct(k),L=c.property("__zoom");(L.k!==k.zoom||L.x!==k.x||L.y!==k.y)&&u?.transform(c,A,null,{sync:!0})}}function N(){const k=c?lr(c.node()):{x:0,y:0,k:1};return{x:k.x,y:k.y,zoom:k.k}}function v(k,A){return c?new Promise(L=>{u?.interpolate(A?.interpolate==="linear"?Et:ot).scaleTo(Mt(c,A?.duration,A?.ease,()=>L(!0)),k)}):Promise.resolve(!1)}function C(k,A){return c?new Promise(L=>{u?.interpolate(A?.interpolate==="linear"?Et:ot).scaleBy(Mt(c,A?.duration,A?.ease,()=>L(!0)),k)}):Promise.resolve(!1)}function $(k){u?.scaleExtent(k)}function z(k){u?.translateExtent(k)}function B(k){const A=!le(k)||k<0?0:k;u?.clickDistance(A)}return{update:w,destroy:p,setViewport:d,setViewportConstrained:E,getViewport:N,scaleTo:v,scaleBy:C,setScaleExtent:$,setTranslateExtent:z,syncViewport:m,setClickDistance:B}}var Ne;(function(e){e.Line="line",e.Handle="handle"})(Ne||(Ne={}));const bi=["top-left","top-right","bottom-left","bottom-right"],Ei=["top","right","bottom","left"];function vi({width:e,prevWidth:t,height:n,prevHeight:o,affectsX:s,affectsY:r}){const i=e-t,a=n-o,f=[i>0?1:i<0?-1:0,a>0?1:a<0?-1:0];return i&&s&&(f[0]=f[0]*-1),a&&r&&(f[1]=f[1]*-1),f}function wn(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),o=e.includes("left"),s=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:o,affectsY:s}}function pe(e,t){return Math.max(0,t-e)}function me(e,t){return Math.max(0,e-t)}function et(e,t,n){return Math.max(0,t-e,e-n)}function bn(e,t){return e?!t:t}function Si(e,t,n,o,s,r,i,a){let{affectsX:f,affectsY:l}=t;const{isHorizontal:h,isVertical:u}=t,c=h&&u,{xSnapped:y,ySnapped:g}=n,{minWidth:b,maxWidth:w,minHeight:p,maxHeight:E}=o,{x:d,y:m,width:N,height:v,aspectRatio:C}=e;let $=Math.floor(h?y-e.pointerX:0),z=Math.floor(u?g-e.pointerY:0);const B=N+(f?-$:$),k=v+(l?-z:z),A=-r[0]*N,L=-r[1]*v;let x=et(B,b,w),M=et(k,p,E);if(i){let I=0,_=0;f&&$<0?I=pe(d+$+A,i[0][0]):!f&&$>0&&(I=me(d+B+A,i[1][0])),l&&z<0?_=pe(m+z+L,i[0][1]):!l&&z>0&&(_=me(m+k+L,i[1][1])),x=Math.max(x,I),M=Math.max(M,_)}if(a){let I=0,_=0;f&&$>0?I=me(d+$,a[0][0]):!f&&$<0&&(I=pe(d+B,a[1][0])),l&&z>0?_=me(m+z,a[0][1]):!l&&z<0&&(_=pe(m+k,a[1][1])),x=Math.max(x,I),M=Math.max(M,_)}if(s){if(h){const I=et(B/C,p,E)*C;if(x=Math.max(x,I),i){let _=0;!f&&!l||f&&!l&&c?_=me(m+L+B/C,i[1][1])*C:_=pe(m+L+(f?$:-$)/C,i[0][1])*C,x=Math.max(x,_)}if(a){let _=0;!f&&!l||f&&!l&&c?_=pe(m+B/C,a[1][1])*C:_=me(m+(f?$:-$)/C,a[0][1])*C,x=Math.max(x,_)}}if(u){const I=et(k*C,b,w)/C;if(M=Math.max(M,I),i){let _=0;!f&&!l||l&&!f&&c?_=me(d+k*C+A,i[1][0])/C:_=pe(d+(l?z:-z)*C+A,i[0][0])/C,M=Math.max(M,_)}if(a){let _=0;!f&&!l||l&&!f&&c?_=pe(d+k*C,a[1][0])/C:_=me(d+(l?z:-z)*C,a[0][0])/C,M=Math.max(M,_)}}}z=z+(z<0?M:-M),$=$+($<0?x:-x),s&&(c?B>k*C?z=(bn(f,l)?-$:$)/C:$=(bn(f,l)?-z:z)*C:h?(z=$/C,l=f):($=z*C,f=l));const S=f?d+$:d,P=l?m+z:m;return{width:N+(f?-$:$),height:v+(l?-z:z),x:r[0]*$*(f?-1:1)+S,y:r[1]*z*(l?-1:1)+P}}const Mo={width:0,height:0,x:0,y:0},Ni={...Mo,pointerX:0,pointerY:0,aspectRatio:1};function Ci(e){return[[0,0],[e.measured.width,e.measured.height]]}function Mi(e,t,n){const o=t.position.x+e.position.x,s=t.position.y+e.position.y,r=e.measured.width??0,i=e.measured.height??0,a=n[0]*r,f=n[1]*i;return[[o-a,s-f],[o+r-a,s+i-f]]}function Ii({domNode:e,nodeId:t,getStoreItems:n,onChange:o,onEnd:s}){const r=ae(e);let i={controlDirection:wn("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function a({controlPosition:l,boundaries:h,keepAspectRatio:u,resizeDirection:c,onResizeStart:y,onResize:g,onResizeEnd:b,shouldResize:w}){let p={...Mo},E={...Ni};i={boundaries:h,resizeDirection:c,keepAspectRatio:u,controlDirection:wn(l)};let d,m=null,N=[],v,C,$,z=!1;const B=Kn().on("start",k=>{const{nodeLookup:A,transform:L,snapGrid:x,snapToGrid:M,nodeOrigin:S,paneDomNode:P}=n();if(d=A.get(t),!d)return;m=P?.getBoundingClientRect()??null;const{xSnapped:I,ySnapped:_}=Ve(k.sourceEvent,{transform:L,snapGrid:x,snapToGrid:M,containerBounds:m});p={width:d.measured.width??0,height:d.measured.height??0,x:d.position.x??0,y:d.position.y??0},E={...p,pointerX:I,pointerY:_,aspectRatio:p.width/p.height},v=void 0,d.parentId&&(d.extent==="parent"||d.expandParent)&&(v=A.get(d.parentId),C=v&&d.extent==="parent"?Ci(v):void 0),N=[],$=void 0;for(const[H,V]of A)if(V.parentId===t&&(N.push({id:H,position:{...V.position},extent:V.extent}),V.extent==="parent"||V.expandParent)){const R=Mi(V,d,V.origin??S);$?$=[[Math.min(R[0][0],$[0][0]),Math.min(R[0][1],$[0][1])],[Math.max(R[1][0],$[1][0]),Math.max(R[1][1],$[1][1])]]:$=R}y?.(k,{...p})}).on("drag",k=>{const{transform:A,snapGrid:L,snapToGrid:x,nodeOrigin:M}=n(),S=Ve(k.sourceEvent,{transform:A,snapGrid:L,snapToGrid:x,containerBounds:m}),P=[];if(!d)return;const{x:I,y:_,width:H,height:V}=p,R={},F=d.origin??M,{width:O,height:W,x:q,y:X}=Si(E,i.controlDirection,S,i.boundaries,i.keepAspectRatio,F,C,$),j=O!==H,Z=W!==V,Q=q!==I&&j,U=X!==_&&Z;if(!Q&&!U&&!j&&!Z)return;if((Q||U||F[0]===1||F[1]===1)&&(R.x=Q?q:p.x,R.y=U?X:p.y,p.x=R.x,p.y=R.y,N.length>0)){const ne=q-I,te=X-_;for(const ie of N)ie.position={x:ie.position.x-ne+F[0]*(O-H),y:ie.position.y-te+F[1]*(W-V)},P.push(ie)}if((j||Z)&&(R.width=j&&(!i.resizeDirection||i.resizeDirection==="horizontal")?O:p.width,R.height=Z&&(!i.resizeDirection||i.resizeDirection==="vertical")?W:p.height,p.width=R.width,p.height=R.height),v&&d.expandParent){const ne=F[0]*(R.width??0);R.x&&R.x<ne&&(p.x=ne,E.x=E.x-(R.x-ne));const te=F[1]*(R.height??0);R.y&&R.y<te&&(p.y=te,E.y=E.y-(R.y-te))}const G=vi({width:p.width,prevWidth:H,height:p.height,prevHeight:V,affectsX:i.controlDirection.affectsX,affectsY:i.controlDirection.affectsY}),K={...p,direction:G};w?.(k,K)!==!1&&(z=!0,g?.(k,K),o(R,P))}).on("end",k=>{z&&(b?.(k,{...p}),s?.({...p}),z=!1)});r.call(B)}function f(){r.on(".drag",null)}return{update:a,destroy:f}}const Pi={},En=e=>{let t;const n=new Set,o=(h,u)=>{const c=typeof h=="function"?h(t):h;if(!Object.is(c,t)){const y=t;t=u??(typeof c!="object"||c===null)?c:Object.assign({},t,c),n.forEach(g=>g(t,y))}},s=()=>t,f={setState:o,getState:s,getInitialState:()=>l,subscribe:h=>(n.add(h),()=>n.delete(h)),destroy:()=>{(Pi?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},l=t=e(o,s,f);return f},ki=e=>e?En(e):En,{useDebugValue:Di}=ur,{useSyncExternalStoreWithSelector:_i}=dr,zi=e=>e;function Io(e,t=zi,n){const o=_i(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Di(o),o}const vn=(e,t)=>{const n=ki(e),o=(s,r=t)=>Io(n,s,r);return Object.assign(o,n),o},$i=(e,t)=>e?vn(e,t):vn;function oe(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,s]of e)if(!Object.is(s,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}const ft=T.createContext(null),Ai=ft.Provider,Po=de.error001();function J(e,t){const n=T.useContext(ft);if(n===null)throw new Error(Po);return Io(n,e,t)}function se(){const e=T.useContext(ft);if(e===null)throw new Error(Po);return T.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const Sn={display:"none"},Ti={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},ko="react-flow__node-desc",Do="react-flow__edge-desc",Hi="react-flow__aria-live",Li=e=>e.ariaLiveMessage,Ri=e=>e.ariaLabelConfig;function Vi({rfId:e}){const t=J(Li);return D.jsx("div",{id:`${Hi}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Ti,children:t})}function Bi({rfId:e,disableKeyboardA11y:t}){const n=J(Ri);return D.jsxs(D.Fragment,{children:[D.jsx("div",{id:`${ko}-${e}`,style:Sn,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),D.jsx("div",{id:`${Do}-${e}`,style:Sn,children:n["edge.a11yDescription.default"]}),!t&&D.jsx(Vi,{rfId:e})]})}const ht=T.forwardRef(({position:e="top-left",children:t,className:n,style:o,...s},r)=>{const i=`${e}`.split("-");return D.jsx("div",{className:re(["react-flow__panel",n,...i]),style:o,ref:r,...s,children:t})});ht.displayName="Panel";function ji({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:D.jsx(ht,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:D.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const Oi=e=>{const t=[],n=[];for(const[,o]of e.nodeLookup)o.selected&&t.push(o.internals.userNode);for(const[,o]of e.edgeLookup)o.selected&&n.push(o);return{selectedNodes:t,selectedEdges:n}},tt=e=>e.id;function Fi(e,t){return oe(e.selectedNodes.map(tt),t.selectedNodes.map(tt))&&oe(e.selectedEdges.map(tt),t.selectedEdges.map(tt))}function Zi({onSelectionChange:e}){const t=se(),{selectedNodes:n,selectedEdges:o}=J(Oi,Fi);return T.useEffect(()=>{const s={nodes:n,edges:o};e?.(s),t.getState().onSelectionChangeHandlers.forEach(r=>r(s))},[n,o,e]),null}const Yi=e=>!!e.onSelectionChangeHandlers;function Xi({onSelectionChange:e}){const t=J(Yi);return e||t?D.jsx(Zi,{onSelectionChange:e}):null}const _o=[0,0],Wi={x:0,y:0,zoom:1},Gi=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode"],Nn=[...Gi,"rfId"],Ki=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges}),Cn={translateExtent:je,nodeOrigin:_o,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function qi(e){const{setNodes:t,setEdges:n,setMinZoom:o,setMaxZoom:s,setTranslateExtent:r,setNodeExtent:i,reset:a,setDefaultNodesAndEdges:f}=J(Ki,oe),l=se();T.useEffect(()=>(f(e.defaultNodes,e.defaultEdges),()=>{h.current=Cn,a()}),[]);const h=T.useRef(Cn);return T.useEffect(()=>{for(const u of Nn){const c=e[u],y=h.current[u];c!==y&&(typeof e[u]>"u"||(u==="nodes"?t(c):u==="edges"?n(c):u==="minZoom"?o(c):u==="maxZoom"?s(c):u==="translateExtent"?r(c):u==="nodeExtent"?i(c):u==="ariaLabelConfig"?l.setState({ariaLabelConfig:Lr(c)}):u==="fitView"?l.setState({fitViewQueued:c}):u==="fitViewOptions"?l.setState({fitViewOptions:c}):l.setState({[u]:c})))}h.current=e},Nn.map(u=>e[u])),null}function Mn(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function Ui(e){const[t,n]=T.useState(e==="system"?null:e);return T.useEffect(()=>{if(e!=="system"){n(e);return}const o=Mn(),s=()=>n(o?.matches?"dark":"light");return s(),o?.addEventListener("change",s),()=>{o?.removeEventListener("change",s)}},[e]),t!==null?t:Mn()?.matches?"dark":"light"}const In=typeof document<"u"?document:null;function Ye(e=null,t={target:In,actInsideInputWithModifier:!0}){const[n,o]=T.useState(!1),s=T.useRef(!1),r=T.useRef(new Set([])),[i,a]=T.useMemo(()=>{if(e!==null){const l=(Array.isArray(e)?e:[e]).filter(u=>typeof u=="string").map(u=>u.replace("+",`
`).replace(`

`,`
+`).split(`
`)),h=l.reduce((u,c)=>u.concat(...c),[]);return[l,h]}return[[],[]]},[e]);return T.useEffect(()=>{const f=t?.target??In,l=t?.actInsideInputWithModifier??!0;if(e!==null){const h=y=>{if(s.current=y.ctrlKey||y.metaKey||y.shiftKey||y.altKey,(!s.current||s.current&&!l)&&lo(y))return!1;const b=kn(y.code,a);if(r.current.add(y[b]),Pn(i,r.current,!1)){const w=y.composedPath?.()?.[0]||y.target,p=w?.nodeName==="BUTTON"||w?.nodeName==="A";t.preventDefault!==!1&&(s.current||!p)&&y.preventDefault(),o(!0)}},u=y=>{const g=kn(y.code,a);Pn(i,r.current,!0)?(o(!1),r.current.clear()):r.current.delete(y[g]),y.key==="Meta"&&r.current.clear(),s.current=!1},c=()=>{r.current.clear(),o(!1)};return f?.addEventListener("keydown",h),f?.addEventListener("keyup",u),window.addEventListener("blur",c),window.addEventListener("contextmenu",c),()=>{f?.removeEventListener("keydown",h),f?.removeEventListener("keyup",u),window.removeEventListener("blur",c),window.removeEventListener("contextmenu",c)}}},[e,o]),n}function Pn(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(s=>t.has(s)))}function kn(e,t){return t.includes(e)?"code":"key"}const Qi=()=>{const e=se();return T.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:o}=e.getState();return o?o.scaleTo(t,{duration:n?.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[o,s,r],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??o,y:t.y??s,zoom:t.zoom??r},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,o]=e.getState().transform;return{x:t,y:n,zoom:o}},setCenter:async(t,n,o)=>e.getState().setCenter(t,n,o),fitBounds:async(t,n)=>{const{width:o,height:s,minZoom:r,maxZoom:i,panZoom:a}=e.getState(),f=Vt(t,o,s,r,i,n?.padding??.1);return a?(await a.setViewport(f,{duration:n?.duration,ease:n?.ease,interpolate:n?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:o,snapGrid:s,snapToGrid:r,domNode:i}=e.getState();if(!i)return t;const{x:a,y:f}=i.getBoundingClientRect(),l={x:t.x-a,y:t.y-f},h=n.snapGrid??s,u=n.snapToGrid??r;return Ke(l,o,u,h)},flowToScreenPosition:t=>{const{transform:n,domNode:o}=e.getState();if(!o)return t;const{x:s,y:r}=o.getBoundingClientRect(),i=it(t,n);return{x:i.x+s,y:i.y+r}}}),[])};function zo(e,t){const n=[],o=new Map,s=[];for(const r of e)if(r.type==="add"){s.push(r);continue}else if(r.type==="remove"||r.type==="replace")o.set(r.id,[r]);else{const i=o.get(r.id);i?i.push(r):o.set(r.id,[r])}for(const r of t){const i=o.get(r.id);if(!i){n.push(r);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){n.push({...i[0].item});continue}const a={...r};for(const f of i)Ji(f,a);n.push(a)}return s.length&&s.forEach(r=>{r.index!==void 0?n.splice(r.index,0,{...r.item}):n.push({...r.item})}),n}function Ji(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured={...e.dimensions},e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function ea(e,t){return zo(e,t)}function ta(e,t){return zo(e,t)}function be(e,t){return{id:e,type:"select",selected:t}}function Pe(e,t=new Set,n=!1){const o=[];for(const[s,r]of e){const i=t.has(s);!(r.selected===void 0&&!i)&&r.selected!==i&&(n&&(r.selected=i),o.push(be(r.id,i)))}return o}function Dn({items:e=[],lookup:t}){const n=[],o=new Map(e.map(s=>[s.id,s]));for(const[s,r]of e.entries()){const i=t.get(r.id),a=i?.internals?.userNode??i;a!==void 0&&a!==r&&n.push({id:r.id,item:r,type:"replace"}),a===void 0&&n.push({item:r,type:"add",index:s})}for(const[s]of t)o.get(s)===void 0&&n.push({id:s,type:"remove"});return n}function _n(e){return{id:e.id,type:"remove"}}const zn=e=>Ir(e),na=e=>to(e);function $o(e){return T.forwardRef(e)}const oa=typeof window<"u"?T.useLayoutEffect:T.useEffect;function $n(e){const[t,n]=T.useState(BigInt(0)),[o]=T.useState(()=>sa(()=>n(s=>s+BigInt(1))));return oa(()=>{const s=o.get();s.length&&(e(s),o.reset())},[t]),o}function sa(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const Ao=T.createContext(null);function ra({children:e}){const t=se(),n=T.useCallback(a=>{const{nodes:f=[],setNodes:l,hasDefaultNodes:h,onNodesChange:u,nodeLookup:c,fitViewQueued:y,onNodesChangeMiddlewareMap:g}=t.getState();let b=f;for(const p of a)b=typeof p=="function"?p(b):p;let w=Dn({items:b,lookup:c});for(const p of g.values())w=p(w);h&&l(b),w.length>0?u?.(w):y&&window.requestAnimationFrame(()=>{const{fitViewQueued:p,nodes:E,setNodes:d}=t.getState();p&&d(E)})},[]),o=$n(n),s=T.useCallback(a=>{const{edges:f=[],setEdges:l,hasDefaultEdges:h,onEdgesChange:u,edgeLookup:c}=t.getState();let y=f;for(const g of a)y=typeof g=="function"?g(y):g;h?l(y):u&&u(Dn({items:y,lookup:c}))},[]),r=$n(s),i=T.useMemo(()=>({nodeQueue:o,edgeQueue:r}),[]);return D.jsx(Ao.Provider,{value:i,children:e})}function ia(){const e=T.useContext(Ao);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const aa=e=>!!e.panZoom;function Xt(){const e=Qi(),t=se(),n=ia(),o=J(aa),s=T.useMemo(()=>{const r=u=>t.getState().nodeLookup.get(u),i=u=>{n.nodeQueue.push(u)},a=u=>{n.edgeQueue.push(u)},f=u=>{const{nodeLookup:c,nodeOrigin:y}=t.getState(),g=zn(u)?u:c.get(u.id),b=g.parentId?ao(g.position,g.measured,g.parentId,c,y):g.position,w={...g,position:b,width:g.measured?.width??g.width,height:g.measured?.height??g.height};return ze(w)},l=(u,c,y={replace:!1})=>{i(g=>g.map(b=>{if(b.id===u){const w=typeof c=="function"?c(b):c;return y.replace&&zn(w)?w:{...b,...w}}return b}))},h=(u,c,y={replace:!1})=>{a(g=>g.map(b=>{if(b.id===u){const w=typeof c=="function"?c(b):c;return y.replace&&na(w)?w:{...b,...w}}return b}))};return{getNodes:()=>t.getState().nodes.map(u=>({...u})),getNode:u=>r(u)?.internals.userNode,getInternalNode:r,getEdges:()=>{const{edges:u=[]}=t.getState();return u.map(c=>({...c}))},getEdge:u=>t.getState().edgeLookup.get(u),setNodes:i,setEdges:a,addNodes:u=>{const c=Array.isArray(u)?u:[u];n.nodeQueue.push(y=>[...y,...c])},addEdges:u=>{const c=Array.isArray(u)?u:[u];n.edgeQueue.push(y=>[...y,...c])},toObject:()=>{const{nodes:u=[],edges:c=[],transform:y}=t.getState(),[g,b,w]=y;return{nodes:u.map(p=>({...p})),edges:c.map(p=>({...p})),viewport:{x:g,y:b,zoom:w}}},deleteElements:async({nodes:u=[],edges:c=[]})=>{const{nodes:y,edges:g,onNodesDelete:b,onEdgesDelete:w,triggerNodeChanges:p,triggerEdgeChanges:E,onDelete:d,onBeforeDelete:m}=t.getState(),{nodes:N,edges:v}=await zr({nodesToRemove:u,edgesToRemove:c,nodes:y,edges:g,onBeforeDelete:m}),C=v.length>0,$=N.length>0;if(C){const z=v.map(_n);w?.(v),E(z)}if($){const z=N.map(_n);b?.(N),p(z)}return($||C)&&d?.({nodes:N,edges:v}),{deletedNodes:N,deletedEdges:v}},getIntersectingNodes:(u,c=!0,y)=>{const g=cn(u),b=g?u:f(u),w=y!==void 0;return b?(y||t.getState().nodes).filter(p=>{const E=t.getState().nodeLookup.get(p.id);if(E&&!g&&(p.id===u.id||!E.internals.positionAbsolute))return!1;const d=ze(w?p:E),m=Fe(d,b);return c&&m>0||m>=d.width*d.height||m>=b.width*b.height}):[]},isNodeIntersecting:(u,c,y=!0)=>{const b=cn(u)?u:f(u);if(!b)return!1;const w=Fe(b,c);return y&&w>0||w>=c.width*c.height||w>=b.width*b.height},updateNode:l,updateNodeData:(u,c,y={replace:!1})=>{l(u,g=>{const b=typeof c=="function"?c(g):c;return y.replace?{...g,data:b}:{...g,data:{...g.data,...b}}},y)},updateEdge:h,updateEdgeData:(u,c,y={replace:!1})=>{h(u,g=>{const b=typeof c=="function"?c(g):c;return y.replace?{...g,data:b}:{...g,data:{...g.data,...b}}},y)},getNodesBounds:u=>{const{nodeLookup:c,nodeOrigin:y}=t.getState();return Pr(u,{nodeLookup:c,nodeOrigin:y})},getHandleConnections:({type:u,id:c,nodeId:y})=>Array.from(t.getState().connectionLookup.get(`${y}-${u}${c?`-${c}`:""}`)?.values()??[]),getNodeConnections:({type:u,handleId:c,nodeId:y})=>Array.from(t.getState().connectionLookup.get(`${y}${u?c?`-${u}-${c}`:`-${u}`:""}`)?.values()??[]),fitView:async u=>{const c=t.getState().fitViewResolver??Hr();return t.setState({fitViewQueued:!0,fitViewOptions:u,fitViewResolver:c}),n.nodeQueue.push(y=>[...y]),c.promise}}},[]);return T.useMemo(()=>({...s,...e,viewportInitialized:o}),[o])}const An=e=>e.selected,ca=typeof window<"u"?window:void 0;function la({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=se(),{deleteElements:o}=Xt(),s=Ye(e,{actInsideInputWithModifier:!1}),r=Ye(t,{target:ca});T.useEffect(()=>{if(s){const{edges:i,nodes:a}=n.getState();o({nodes:a.filter(An),edges:i.filter(An)}),n.setState({nodesSelectionActive:!1})}},[s]),T.useEffect(()=>{n.setState({multiSelectionActive:r})},[r])}function ua(e){const t=se();T.useEffect(()=>{const n=()=>{if(!e.current||!(e.current.checkVisibility?.()??!0))return!1;const o=Bt(e.current);(o.height===0||o.width===0)&&t.getState().onError?.("004",de.error004()),t.setState({width:o.width||500,height:o.height||500})};if(e.current){n(),window.addEventListener("resize",n);const o=new ResizeObserver(()=>n());return o.observe(e.current),()=>{window.removeEventListener("resize",n),o&&e.current&&o.unobserve(e.current)}}},[])}const gt={position:"absolute",width:"100%",height:"100%",top:0,left:0},da=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib,connectionInProgress:e.connection.inProgress});function fa({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:o=!1,panOnScrollSpeed:s=.5,panOnScrollMode:r=Ee.Free,zoomOnDoubleClick:i=!0,panOnDrag:a=!0,defaultViewport:f,translateExtent:l,minZoom:h,maxZoom:u,zoomActivationKeyCode:c,preventScrolling:y=!0,children:g,noWheelClassName:b,noPanClassName:w,onViewportChange:p,isControlledViewport:E,paneClickDistance:d,selectionOnDrag:m}){const N=se(),v=T.useRef(null),{userSelectionActive:C,lib:$,connectionInProgress:z}=J(da,oe),B=Ye(c),k=T.useRef();ua(v);const A=T.useCallback(L=>{p?.({x:L[0],y:L[1],zoom:L[2]}),E||N.setState({transform:L})},[p,E]);return T.useEffect(()=>{if(v.current){k.current=wi({domNode:v.current,minZoom:h,maxZoom:u,translateExtent:l,viewport:f,onDraggingChange:S=>N.setState({paneDragging:S}),onPanZoomStart:(S,P)=>{const{onViewportChangeStart:I,onMoveStart:_}=N.getState();_?.(S,P),I?.(P)},onPanZoom:(S,P)=>{const{onViewportChange:I,onMove:_}=N.getState();_?.(S,P),I?.(P)},onPanZoomEnd:(S,P)=>{const{onViewportChangeEnd:I,onMoveEnd:_}=N.getState();_?.(S,P),I?.(P)}});const{x:L,y:x,zoom:M}=k.current.getViewport();return N.setState({panZoom:k.current,transform:[L,x,M],domNode:v.current.closest(".react-flow")}),()=>{k.current?.destroy()}}},[]),T.useEffect(()=>{k.current?.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:o,panOnScrollSpeed:s,panOnScrollMode:r,zoomOnDoubleClick:i,panOnDrag:a,zoomActivationKeyPressed:B,preventScrolling:y,noPanClassName:w,userSelectionActive:C,noWheelClassName:b,lib:$,onTransformChange:A,connectionInProgress:z,selectionOnDrag:m,paneClickDistance:d})},[e,t,n,o,s,r,i,a,B,y,w,C,b,$,A,z,m,d]),D.jsx("div",{className:"react-flow__renderer",ref:v,style:gt,children:g})}const ha=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function ga(){const{userSelectionActive:e,userSelectionRect:t}=J(ha,oe);return e&&t?D.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const It=(e,t)=>n=>{n.target===t.current&&e?.(n)},pa=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function ma({isSelecting:e,selectionKeyPressed:t,selectionMode:n=Oe.Full,panOnDrag:o,paneClickDistance:s,selectionOnDrag:r,onSelectionStart:i,onSelectionEnd:a,onPaneClick:f,onPaneContextMenu:l,onPaneScroll:h,onPaneMouseEnter:u,onPaneMouseMove:c,onPaneMouseLeave:y,children:g}){const b=se(),{userSelectionActive:w,elementsSelectable:p,dragging:E,connectionInProgress:d}=J(pa,oe),m=p&&(e||w),N=T.useRef(null),v=T.useRef(),C=T.useRef(new Set),$=T.useRef(new Set),z=T.useRef(!1),B=I=>{if(z.current||d){z.current=!1;return}f?.(I),b.getState().resetSelectedElements(),b.setState({nodesSelectionActive:!1})},k=I=>{if(Array.isArray(o)&&o?.includes(2)){I.preventDefault();return}l?.(I)},A=h?I=>h(I):void 0,L=I=>{z.current&&(I.stopPropagation(),z.current=!1)},x=I=>{const{domNode:_}=b.getState();if(v.current=_?.getBoundingClientRect(),!v.current)return;const H=I.target===N.current;if(!H&&!!I.target.closest(".nokey")||!e||!(r&&H||t)||I.button!==0||!I.isPrimary)return;I.target?.setPointerCapture?.(I.pointerId),z.current=!1;const{x:F,y:O}=ue(I.nativeEvent,v.current);b.setState({userSelectionRect:{width:0,height:0,startX:F,startY:O,x:F,y:O}}),H||(I.stopPropagation(),I.preventDefault())},M=I=>{const{userSelectionRect:_,transform:H,nodeLookup:V,edgeLookup:R,connectionLookup:F,triggerNodeChanges:O,triggerEdgeChanges:W,defaultEdgeOptions:q,resetSelectedElements:X}=b.getState();if(!v.current||!_)return;const{x:j,y:Z}=ue(I.nativeEvent,v.current),{startX:Q,startY:U}=_;if(!z.current){const te=t?0:s;if(Math.hypot(j-Q,Z-U)<=te)return;X(),i?.(I)}z.current=!0;const G={startX:Q,startY:U,x:j<Q?j:Q,y:Z<U?Z:U,width:Math.abs(j-Q),height:Math.abs(Z-U)},K=C.current,ee=$.current;C.current=new Set(Rt(V,G,H,n===Oe.Partial,!0).map(te=>te.id)),$.current=new Set;const ne=q?.selectable??!0;for(const te of C.current){const ie=F.get(te);if(ie)for(const{edgeId:ge}of ie.values()){const fe=R.get(ge);fe&&(fe.selectable??ne)&&$.current.add(ge)}}if(!ln(K,C.current)){const te=Pe(V,C.current,!0);O(te)}if(!ln(ee,$.current)){const te=Pe(R,$.current);W(te)}b.setState({userSelectionRect:G,userSelectionActive:!0,nodesSelectionActive:!1})},S=I=>{I.button===0&&(I.target?.releasePointerCapture?.(I.pointerId),!w&&I.target===N.current&&b.getState().userSelectionRect&&B?.(I),b.setState({userSelectionActive:!1,userSelectionRect:null}),z.current&&(a?.(I),b.setState({nodesSelectionActive:C.current.size>0})))},P=o===!0||Array.isArray(o)&&o.includes(0);return D.jsxs("div",{className:re(["react-flow__pane",{draggable:P,dragging:E,selection:e}]),onClick:m?void 0:It(B,N),onContextMenu:It(k,N),onWheel:It(A,N),onPointerEnter:m?void 0:u,onPointerMove:m?M:c,onPointerUp:m?S:void 0,onPointerDownCapture:m?x:void 0,onClickCapture:m?L:void 0,onPointerLeave:y,ref:N,style:gt,children:[g,D.jsx(ga,{})]})}function Tt({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:s,unselectNodesAndEdges:r,multiSelectionActive:i,nodeLookup:a,onError:f}=t.getState(),l=a.get(e);if(!l){f?.("012",de.error012(e));return}t.setState({nodesSelectionActive:!1}),l.selected?(n||l.selected&&i)&&(r({nodes:[l],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):s([e])}function To({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:s,isSelectable:r,nodeClickDistance:i}){const a=se(),[f,l]=T.useState(!1),h=T.useRef();return T.useEffect(()=>{h.current=ri({getStoreItems:()=>a.getState(),onNodeMouseDown:u=>{Tt({id:u,store:a,nodeRef:e})},onDragStart:()=>{l(!0)},onDragStop:()=>{l(!1)}})},[]),T.useEffect(()=>{if(t)h.current?.destroy();else if(e.current)return h.current?.update({noDragClassName:n,handleSelector:o,domNode:e.current,isSelectable:r,nodeId:s,nodeClickDistance:i}),()=>{h.current?.destroy()}},[n,o,t,r,e,s]),f}const ya=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function Ho(){const e=se();return T.useCallback(n=>{const{nodeExtent:o,snapToGrid:s,snapGrid:r,nodesDraggable:i,onError:a,updateNodePositions:f,nodeLookup:l,nodeOrigin:h}=e.getState(),u=new Map,c=ya(i),y=s?r[0]:5,g=s?r[1]:5,b=n.direction.x*y*n.factor,w=n.direction.y*g*n.factor;for(const[,p]of l){if(!c(p))continue;let E={x:p.internals.positionAbsolute.x+b,y:p.internals.positionAbsolute.y+w};s&&(E=Ge(E,r));const{position:d,positionAbsolute:m}=no({nodeId:p.id,nextPosition:E,nodeLookup:l,nodeExtent:o,nodeOrigin:h,onError:a});p.position=d,p.internals.positionAbsolute=m,u.set(p.id,p)}f(u)},[])}const Wt=T.createContext(null),xa=Wt.Provider;Wt.Consumer;const Lo=()=>T.useContext(Wt),wa=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),ba=(e,t,n)=>o=>{const{connectionClickStartHandle:s,connectionMode:r,connection:i}=o,{fromHandle:a,toHandle:f,isValid:l}=i,h=f?.nodeId===e&&f?.id===t&&f?.type===n;return{connectingFrom:a?.nodeId===e&&a?.id===t&&a?.type===n,connectingTo:h,clickConnecting:s?.nodeId===e&&s?.id===t&&s?.type===n,isPossibleEndHandle:r===De.Strict?a?.type!==n:e!==a?.nodeId||t!==a?.id,connectionInProcess:!!a,clickConnectionInProcess:!!s,valid:h&&l}};function Ea({type:e="source",position:t=Y.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:s=!0,isConnectableEnd:r=!0,id:i,onConnect:a,children:f,className:l,onMouseDown:h,onTouchStart:u,...c},y){const g=i||null,b=e==="target",w=se(),p=Lo(),{connectOnClick:E,noPanClassName:d,rfId:m}=J(wa,oe),{connectingFrom:N,connectingTo:v,clickConnecting:C,isPossibleEndHandle:$,connectionInProcess:z,clickConnectionInProcess:B,valid:k}=J(ba(p,g,e),oe);p||w.getState().onError?.("010",de.error010());const A=M=>{const{defaultEdgeOptions:S,onConnect:P,hasDefaultEdges:I}=w.getState(),_={...S,...M};if(I){const{edges:H,setEdges:V}=w.getState();V(Fr(_,H))}P?.(_),a?.(_)},L=M=>{if(!p)return;const S=uo(M.nativeEvent);if(s&&(S&&M.button===0||!S)){const P=w.getState();At.onPointerDown(M.nativeEvent,{handleDomNode:M.currentTarget,autoPanOnConnect:P.autoPanOnConnect,connectionMode:P.connectionMode,connectionRadius:P.connectionRadius,domNode:P.domNode,nodeLookup:P.nodeLookup,lib:P.lib,isTarget:b,handleId:g,nodeId:p,flowId:P.rfId,panBy:P.panBy,cancelConnection:P.cancelConnection,onConnectStart:P.onConnectStart,onConnectEnd:P.onConnectEnd,updateConnection:P.updateConnection,onConnect:A,isValidConnection:n||P.isValidConnection,getTransform:()=>w.getState().transform,getFromHandle:()=>w.getState().connection.fromHandle,autoPanSpeed:P.autoPanSpeed,dragThreshold:P.connectionDragThreshold})}S?h?.(M):u?.(M)},x=M=>{const{onClickConnectStart:S,onClickConnectEnd:P,connectionClickStartHandle:I,connectionMode:_,isValidConnection:H,lib:V,rfId:R,nodeLookup:F,connection:O}=w.getState();if(!p||!I&&!s)return;if(!I){S?.(M.nativeEvent,{nodeId:p,handleId:g,handleType:e}),w.setState({connectionClickStartHandle:{nodeId:p,type:e,id:g}});return}const W=co(M.target),q=n||H,{connection:X,isValid:j}=At.isValid(M.nativeEvent,{handle:{nodeId:p,id:g,type:e},connectionMode:_,fromNodeId:I.nodeId,fromHandleId:I.id||null,fromType:I.type,isValidConnection:q,flowId:R,doc:W,lib:V,nodeLookup:F});j&&X&&A(X);const Z=structuredClone(O);delete Z.inProgress,Z.toPosition=Z.toHandle?Z.toHandle.position:null,P?.(M,Z),w.setState({connectionClickStartHandle:null})};return D.jsx("div",{"data-handleid":g,"data-nodeid":p,"data-handlepos":t,"data-id":`${m}-${p}-${g}-${e}`,className:re(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",d,l,{source:!b,target:b,connectable:o,connectablestart:s,connectableend:r,clickconnecting:C,connectingfrom:N,connectingto:v,valid:k,connectionindicator:o&&(!z||$)&&(z||B?r:s)}]),onMouseDown:L,onTouchStart:L,onClick:E?x:void 0,ref:y,...c,children:f})}const at=T.memo($o(Ea));function va({data:e,isConnectable:t,sourcePosition:n=Y.Bottom}){return D.jsxs(D.Fragment,{children:[e?.label,D.jsx(at,{type:"source",position:n,isConnectable:t})]})}function Sa({data:e,isConnectable:t,targetPosition:n=Y.Top,sourcePosition:o=Y.Bottom}){return D.jsxs(D.Fragment,{children:[D.jsx(at,{type:"target",position:n,isConnectable:t}),e?.label,D.jsx(at,{type:"source",position:o,isConnectable:t})]})}function Na(){return null}function Ca({data:e,isConnectable:t,targetPosition:n=Y.Top}){return D.jsxs(D.Fragment,{children:[D.jsx(at,{type:"target",position:n,isConnectable:t}),e?.label]})}const ct={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Tn={input:va,default:Sa,output:Ca,group:Na};function Ma(e){return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??e.style?.width,height:e.height??e.initialHeight??e.style?.height}:{width:e.width??e.style?.width,height:e.height??e.style?.height}}const Ia=e=>{const{width:t,height:n,x:o,y:s}=We(e.nodeLookup,{filter:r=>!!r.selected});return{width:le(t)?t:null,height:le(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${o}px,${s}px)`}};function Pa({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=se(),{width:s,height:r,transformString:i,userSelectionActive:a}=J(Ia,oe),f=Ho(),l=T.useRef(null);if(T.useEffect(()=>{n||l.current?.focus({preventScroll:!0})},[n]),To({nodeRef:l}),a||!s||!r)return null;const h=e?c=>{const y=o.getState().nodes.filter(g=>g.selected);e(c,y)}:void 0,u=c=>{Object.prototype.hasOwnProperty.call(ct,c.key)&&(c.preventDefault(),f({direction:ct[c.key],factor:c.shiftKey?4:1}))};return D.jsx("div",{className:re(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:D.jsx("div",{ref:l,className:"react-flow__nodesselection-rect",onContextMenu:h,tabIndex:n?void 0:-1,onKeyDown:n?void 0:u,style:{width:s,height:r}})})}const Hn=typeof window<"u"?window:void 0,ka=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function Ro({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:r,onPaneScroll:i,paneClickDistance:a,deleteKeyCode:f,selectionKeyCode:l,selectionOnDrag:h,selectionMode:u,onSelectionStart:c,onSelectionEnd:y,multiSelectionKeyCode:g,panActivationKeyCode:b,zoomActivationKeyCode:w,elementsSelectable:p,zoomOnScroll:E,zoomOnPinch:d,panOnScroll:m,panOnScrollSpeed:N,panOnScrollMode:v,zoomOnDoubleClick:C,panOnDrag:$,defaultViewport:z,translateExtent:B,minZoom:k,maxZoom:A,preventScrolling:L,onSelectionContextMenu:x,noWheelClassName:M,noPanClassName:S,disableKeyboardA11y:P,onViewportChange:I,isControlledViewport:_}){const{nodesSelectionActive:H,userSelectionActive:V}=J(ka,oe),R=Ye(l,{target:Hn}),F=Ye(b,{target:Hn}),O=F||$,W=F||m,q=h&&O!==!0,X=R||V||q;return la({deleteKeyCode:f,multiSelectionKeyCode:g}),D.jsx(fa,{onPaneContextMenu:r,elementsSelectable:p,zoomOnScroll:E,zoomOnPinch:d,panOnScroll:W,panOnScrollSpeed:N,panOnScrollMode:v,zoomOnDoubleClick:C,panOnDrag:!R&&O,defaultViewport:z,translateExtent:B,minZoom:k,maxZoom:A,zoomActivationKeyCode:w,preventScrolling:L,noWheelClassName:M,noPanClassName:S,onViewportChange:I,isControlledViewport:_,paneClickDistance:a,selectionOnDrag:q,children:D.jsxs(ma,{onSelectionStart:c,onSelectionEnd:y,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:r,onPaneScroll:i,panOnDrag:O,isSelecting:!!X,selectionMode:u,selectionKeyPressed:R,paneClickDistance:a,selectionOnDrag:q,children:[e,H&&D.jsx(Pa,{onSelectionContextMenu:x,noPanClassName:S,disableKeyboardA11y:P})]})})}Ro.displayName="FlowRenderer";const Da=T.memo(Ro),_a=e=>t=>e?Rt(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function za(e){return J(T.useCallback(_a(e),[e]),oe)}const $a=e=>e.updateNodeInternals;function Aa(){const e=J($a),[t]=T.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const o=new Map;n.forEach(s=>{const r=s.target.getAttribute("data-id");o.set(r,{id:r,nodeElement:s.target,force:!0})}),e(o)}));return T.useEffect(()=>()=>{t?.disconnect()},[t]),t}function Ta({node:e,nodeType:t,hasDimensions:n,resizeObserver:o}){const s=se(),r=T.useRef(null),i=T.useRef(null),a=T.useRef(e.sourcePosition),f=T.useRef(e.targetPosition),l=T.useRef(t),h=n&&!!e.internals.handleBounds;return T.useEffect(()=>{r.current&&!e.hidden&&(!h||i.current!==r.current)&&(i.current&&o?.unobserve(i.current),o?.observe(r.current),i.current=r.current)},[h,e.hidden]),T.useEffect(()=>()=>{i.current&&(o?.unobserve(i.current),i.current=null)},[]),T.useEffect(()=>{if(r.current){const u=l.current!==t,c=a.current!==e.sourcePosition,y=f.current!==e.targetPosition;(u||c||y)&&(l.current=t,a.current=e.sourcePosition,f.current=e.targetPosition,s.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:r.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),r}function Ha({id:e,onClick:t,onMouseEnter:n,onMouseMove:o,onMouseLeave:s,onContextMenu:r,onDoubleClick:i,nodesDraggable:a,elementsSelectable:f,nodesConnectable:l,nodesFocusable:h,resizeObserver:u,noDragClassName:c,noPanClassName:y,disableKeyboardA11y:g,rfId:b,nodeTypes:w,nodeClickDistance:p,onError:E}){const{node:d,internals:m,isParent:N}=J(j=>{const Z=j.nodeLookup.get(e),Q=j.parentLookup.has(e);return{node:Z,internals:Z.internals,isParent:Q}},oe);let v=d.type||"default",C=w?.[v]||Tn[v];C===void 0&&(E?.("003",de.error003(v)),v="default",C=w?.default||Tn.default);const $=!!(d.draggable||a&&typeof d.draggable>"u"),z=!!(d.selectable||f&&typeof d.selectable>"u"),B=!!(d.connectable||l&&typeof d.connectable>"u"),k=!!(d.focusable||h&&typeof d.focusable>"u"),A=se(),L=io(d),x=Ta({node:d,nodeType:v,hasDimensions:L,resizeObserver:u}),M=To({nodeRef:x,disabled:d.hidden||!$,noDragClassName:c,handleSelector:d.dragHandle,nodeId:e,isSelectable:z,nodeClickDistance:p}),S=Ho();if(d.hidden)return null;const P=he(d),I=Ma(d),_=z||$||t||n||o||s,H=n?j=>n(j,{...m.userNode}):void 0,V=o?j=>o(j,{...m.userNode}):void 0,R=s?j=>s(j,{...m.userNode}):void 0,F=r?j=>r(j,{...m.userNode}):void 0,O=i?j=>i(j,{...m.userNode}):void 0,W=j=>{const{selectNodesOnDrag:Z,nodeDragThreshold:Q}=A.getState();z&&(!Z||!$||Q>0)&&Tt({id:e,store:A,nodeRef:x}),t&&t(j,{...m.userNode})},q=j=>{if(!(lo(j.nativeEvent)||g)){if(Un.includes(j.key)&&z){const Z=j.key==="Escape";Tt({id:e,store:A,unselect:Z,nodeRef:x})}else if($&&d.selected&&Object.prototype.hasOwnProperty.call(ct,j.key)){j.preventDefault();const{ariaLabelConfig:Z}=A.getState();A.setState({ariaLiveMessage:Z["node.a11yDescription.ariaLiveMessage"]({direction:j.key.replace("Arrow","").toLowerCase(),x:~~m.positionAbsolute.x,y:~~m.positionAbsolute.y})}),S({direction:ct[j.key],factor:j.shiftKey?4:1})}}},X=()=>{if(g||!x.current?.matches(":focus-visible"))return;const{transform:j,width:Z,height:Q,autoPanOnNodeFocus:U,setCenter:G}=A.getState();if(!U)return;Rt(new Map([[e,d]]),{x:0,y:0,width:Z,height:Q},j,!0).length>0||G(d.position.x+P.width/2,d.position.y+P.height/2,{zoom:j[2]})};return D.jsx("div",{className:re(["react-flow__node",`react-flow__node-${v}`,{[y]:$},d.className,{selected:d.selected,selectable:z,parent:N,draggable:$,dragging:M}]),ref:x,style:{zIndex:m.z,transform:`translate(${m.positionAbsolute.x}px,${m.positionAbsolute.y}px)`,pointerEvents:_?"all":"none",visibility:L?"visible":"hidden",...d.style,...I},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:H,onMouseMove:V,onMouseLeave:R,onContextMenu:F,onClick:W,onDoubleClick:O,onKeyDown:k?q:void 0,tabIndex:k?0:void 0,onFocus:k?X:void 0,role:d.ariaRole??(k?"group":void 0),"aria-roledescription":"node","aria-describedby":g?void 0:`${ko}-${b}`,"aria-label":d.ariaLabel,...d.domAttributes,children:D.jsx(xa,{value:e,children:D.jsx(C,{id:e,data:d.data,type:v,positionAbsoluteX:m.positionAbsolute.x,positionAbsoluteY:m.positionAbsolute.y,selected:d.selected??!1,selectable:z,draggable:$,deletable:d.deletable??!0,isConnectable:B,sourcePosition:d.sourcePosition,targetPosition:d.targetPosition,dragging:M,dragHandle:d.dragHandle,zIndex:m.z,parentId:d.parentId,...P})})})}var La=T.memo(Ha);const Ra=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function Vo(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:s,onError:r}=J(Ra,oe),i=za(e.onlyRenderVisibleElements),a=Aa();return D.jsx("div",{className:"react-flow__nodes",style:gt,children:i.map(f=>D.jsx(La,{id:f,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:s,nodeClickDistance:e.nodeClickDistance,onError:r},f))})}Vo.displayName="NodeRenderer";const Va=T.memo(Vo);function Ba(e){return J(T.useCallback(n=>{if(!e)return n.edges.map(s=>s.id);const o=[];if(n.width&&n.height)for(const s of n.edges){const r=n.nodeLookup.get(s.source),i=n.nodeLookup.get(s.target);r&&i&&Br({sourceNode:r,targetNode:i,width:n.width,height:n.height,transform:n.transform})&&o.push(s.id)}return o},[e]),oe)}const ja=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e}};return D.jsx("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},Oa=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e,fill:e}};return D.jsx("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},Ln={[st.Arrow]:ja,[st.ArrowClosed]:Oa};function Fa(e){const t=se();return T.useMemo(()=>Object.prototype.hasOwnProperty.call(Ln,e)?Ln[e]:(t.getState().onError?.("009",de.error009(e)),null),[e])}const Za=({id:e,type:t,color:n,width:o=12.5,height:s=12.5,markerUnits:r="strokeWidth",strokeWidth:i,orient:a="auto-start-reverse"})=>{const f=Fa(t);return f?D.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:r,orient:a,refX:"0",refY:"0",children:D.jsx(f,{color:n,strokeWidth:i})}):null},Bo=({defaultColor:e,rfId:t})=>{const n=J(r=>r.edges),o=J(r=>r.defaultEdgeOptions),s=T.useMemo(()=>Gr(n,{id:t,defaultColor:e,defaultMarkerStart:o?.markerStart,defaultMarkerEnd:o?.markerEnd}),[n,o,t,e]);return s.length?D.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:D.jsx("defs",{children:s.map(r=>D.jsx(Za,{id:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient},r.id))})}):null};Bo.displayName="MarkerDefinitions";var Ya=T.memo(Bo);function jo({x:e,y:t,label:n,labelStyle:o,labelShowBg:s=!0,labelBgStyle:r,labelBgPadding:i=[2,4],labelBgBorderRadius:a=2,children:f,className:l,...h}){const[u,c]=T.useState({x:1,y:0,width:0,height:0}),y=re(["react-flow__edge-textwrapper",l]),g=T.useRef(null);return T.useEffect(()=>{if(g.current){const b=g.current.getBBox();c({x:b.x,y:b.y,width:b.width,height:b.height})}},[n]),n?D.jsxs("g",{transform:`translate(${e-u.width/2} ${t-u.height/2})`,className:y,visibility:u.width?"visible":"hidden",...h,children:[s&&D.jsx("rect",{width:u.width+2*i[0],x:-i[0],y:-i[1],height:u.height+2*i[1],className:"react-flow__edge-textbg",style:r,rx:a,ry:a}),D.jsx("text",{className:"react-flow__edge-text",y:u.height/2,dy:"0.3em",ref:g,style:o,children:n}),f]}):null}jo.displayName="EdgeText";const Xa=T.memo(jo);function pt({path:e,labelX:t,labelY:n,label:o,labelStyle:s,labelShowBg:r,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:f,interactionWidth:l=20,...h}){return D.jsxs(D.Fragment,{children:[D.jsx("path",{...h,d:e,fill:"none",className:re(["react-flow__edge-path",h.className])}),l?D.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:l,className:"react-flow__edge-interaction"}):null,o&&le(t)&&le(n)?D.jsx(Xa,{x:t,y:n,label:o,labelStyle:s,labelShowBg:r,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:f}):null]})}function Rn({pos:e,x1:t,y1:n,x2:o,y2:s}){return e===Y.Left||e===Y.Right?[.5*(t+o),n]:[t,.5*(n+s)]}function Oo({sourceX:e,sourceY:t,sourcePosition:n=Y.Bottom,targetX:o,targetY:s,targetPosition:r=Y.Top}){const[i,a]=Rn({pos:n,x1:e,y1:t,x2:o,y2:s}),[f,l]=Rn({pos:r,x1:o,y1:s,x2:e,y2:t}),[h,u,c,y]=fo({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:i,sourceControlY:a,targetControlX:f,targetControlY:l});return[`M${e},${t} C${i},${a} ${f},${l} ${o},${s}`,h,u,c,y]}function Fo(e){return T.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,sourcePosition:i,targetPosition:a,label:f,labelStyle:l,labelShowBg:h,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:y,style:g,markerEnd:b,markerStart:w,interactionWidth:p})=>{const[E,d,m]=Oo({sourceX:n,sourceY:o,sourcePosition:i,targetX:s,targetY:r,targetPosition:a}),N=e.isInternal?void 0:t;return D.jsx(pt,{id:N,path:E,labelX:d,labelY:m,label:f,labelStyle:l,labelShowBg:h,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:y,style:g,markerEnd:b,markerStart:w,interactionWidth:p})})}const Wa=Fo({isInternal:!1}),Zo=Fo({isInternal:!0});Wa.displayName="SimpleBezierEdge";Zo.displayName="SimpleBezierEdgeInternal";function Yo(e){return T.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,label:i,labelStyle:a,labelShowBg:f,labelBgStyle:l,labelBgPadding:h,labelBgBorderRadius:u,style:c,sourcePosition:y=Y.Bottom,targetPosition:g=Y.Top,markerEnd:b,markerStart:w,pathOptions:p,interactionWidth:E})=>{const[d,m,N]=_t({sourceX:n,sourceY:o,sourcePosition:y,targetX:s,targetY:r,targetPosition:g,borderRadius:p?.borderRadius,offset:p?.offset,stepPosition:p?.stepPosition}),v=e.isInternal?void 0:t;return D.jsx(pt,{id:v,path:d,labelX:m,labelY:N,label:i,labelStyle:a,labelShowBg:f,labelBgStyle:l,labelBgPadding:h,labelBgBorderRadius:u,style:c,markerEnd:b,markerStart:w,interactionWidth:E})})}const Xo=Yo({isInternal:!1}),Wo=Yo({isInternal:!0});Xo.displayName="SmoothStepEdge";Wo.displayName="SmoothStepEdgeInternal";function Go(e){return T.memo(({id:t,...n})=>{const o=e.isInternal?void 0:t;return D.jsx(Xo,{...n,id:o,pathOptions:T.useMemo(()=>({borderRadius:0,offset:n.pathOptions?.offset}),[n.pathOptions?.offset])})})}const Ga=Go({isInternal:!1}),Ko=Go({isInternal:!0});Ga.displayName="StepEdge";Ko.displayName="StepEdgeInternal";function qo(e){return T.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,label:i,labelStyle:a,labelShowBg:f,labelBgStyle:l,labelBgPadding:h,labelBgBorderRadius:u,style:c,markerEnd:y,markerStart:g,interactionWidth:b})=>{const[w,p,E]=po({sourceX:n,sourceY:o,targetX:s,targetY:r}),d=e.isInternal?void 0:t;return D.jsx(pt,{id:d,path:w,labelX:p,labelY:E,label:i,labelStyle:a,labelShowBg:f,labelBgStyle:l,labelBgPadding:h,labelBgBorderRadius:u,style:c,markerEnd:y,markerStart:g,interactionWidth:b})})}const Ka=qo({isInternal:!1}),Uo=qo({isInternal:!0});Ka.displayName="StraightEdge";Uo.displayName="StraightEdgeInternal";function Qo(e){return T.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,sourcePosition:i=Y.Bottom,targetPosition:a=Y.Top,label:f,labelStyle:l,labelShowBg:h,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:y,style:g,markerEnd:b,markerStart:w,pathOptions:p,interactionWidth:E})=>{const[d,m,N]=ho({sourceX:n,sourceY:o,sourcePosition:i,targetX:s,targetY:r,targetPosition:a,curvature:p?.curvature}),v=e.isInternal?void 0:t;return D.jsx(pt,{id:v,path:d,labelX:m,labelY:N,label:f,labelStyle:l,labelShowBg:h,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:y,style:g,markerEnd:b,markerStart:w,interactionWidth:E})})}const qa=Qo({isInternal:!1}),Jo=Qo({isInternal:!0});qa.displayName="BezierEdge";Jo.displayName="BezierEdgeInternal";const Vn={default:Jo,straight:Uo,step:Ko,smoothstep:Wo,simplebezier:Zo},Bn={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},Ua=(e,t,n)=>n===Y.Left?e-t:n===Y.Right?e+t:e,Qa=(e,t,n)=>n===Y.Top?e-t:n===Y.Bottom?e+t:e,jn="react-flow__edgeupdater";function On({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:s,onMouseEnter:r,onMouseOut:i,type:a}){return D.jsx("circle",{onMouseDown:s,onMouseEnter:r,onMouseOut:i,className:re([jn,`${jn}-${a}`]),cx:Ua(t,o,e),cy:Qa(n,o,e),r:o,stroke:"transparent",fill:"transparent"})}function Ja({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:o,sourceY:s,targetX:r,targetY:i,sourcePosition:a,targetPosition:f,onReconnect:l,onReconnectStart:h,onReconnectEnd:u,setReconnecting:c,setUpdateHover:y}){const g=se(),b=(m,N)=>{if(m.button!==0)return;const{autoPanOnConnect:v,domNode:C,isValidConnection:$,connectionMode:z,connectionRadius:B,lib:k,onConnectStart:A,onConnectEnd:L,cancelConnection:x,nodeLookup:M,rfId:S,panBy:P,updateConnection:I}=g.getState(),_=N.type==="target",H=(F,O)=>{c(!1),u?.(F,n,N.type,O)},V=F=>l?.(n,F),R=(F,O)=>{c(!0),h?.(m,n,N.type),A?.(F,O)};At.onPointerDown(m.nativeEvent,{autoPanOnConnect:v,connectionMode:z,connectionRadius:B,domNode:C,handleId:N.id,nodeId:N.nodeId,nodeLookup:M,isTarget:_,edgeUpdaterType:N.type,lib:k,flowId:S,cancelConnection:x,panBy:P,isValidConnection:$,onConnect:V,onConnectStart:R,onConnectEnd:L,onReconnectEnd:H,updateConnection:I,getTransform:()=>g.getState().transform,getFromHandle:()=>g.getState().connection.fromHandle,dragThreshold:g.getState().connectionDragThreshold,handleDomNode:m.currentTarget})},w=m=>b(m,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),p=m=>b(m,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),E=()=>y(!0),d=()=>y(!1);return D.jsxs(D.Fragment,{children:[(e===!0||e==="source")&&D.jsx(On,{position:a,centerX:o,centerY:s,radius:t,onMouseDown:w,onMouseEnter:E,onMouseOut:d,type:"source"}),(e===!0||e==="target")&&D.jsx(On,{position:f,centerX:r,centerY:i,radius:t,onMouseDown:p,onMouseEnter:E,onMouseOut:d,type:"target"})]})}function ec({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:o,onClick:s,onDoubleClick:r,onContextMenu:i,onMouseEnter:a,onMouseMove:f,onMouseLeave:l,reconnectRadius:h,onReconnect:u,onReconnectStart:c,onReconnectEnd:y,rfId:g,edgeTypes:b,noPanClassName:w,onError:p,disableKeyboardA11y:E}){let d=J(G=>G.edgeLookup.get(e));const m=J(G=>G.defaultEdgeOptions);d=m?{...m,...d}:d;let N=d.type||"default",v=b?.[N]||Vn[N];v===void 0&&(p?.("011",de.error011(N)),N="default",v=b?.default||Vn.default);const C=!!(d.focusable||t&&typeof d.focusable>"u"),$=typeof u<"u"&&(d.reconnectable||n&&typeof d.reconnectable>"u"),z=!!(d.selectable||o&&typeof d.selectable>"u"),B=T.useRef(null),[k,A]=T.useState(!1),[L,x]=T.useState(!1),M=se(),{zIndex:S,sourceX:P,sourceY:I,targetX:_,targetY:H,sourcePosition:V,targetPosition:R}=J(T.useCallback(G=>{const K=G.nodeLookup.get(d.source),ee=G.nodeLookup.get(d.target);if(!K||!ee)return{zIndex:d.zIndex,...Bn};const ne=Wr({id:e,sourceNode:K,targetNode:ee,sourceHandle:d.sourceHandle||null,targetHandle:d.targetHandle||null,connectionMode:G.connectionMode,onError:p});return{zIndex:Vr({selected:d.selected,zIndex:d.zIndex,sourceNode:K,targetNode:ee,elevateOnSelect:G.elevateEdgesOnSelect,zIndexMode:G.zIndexMode}),...ne||Bn}},[d.source,d.target,d.sourceHandle,d.targetHandle,d.selected,d.zIndex]),oe),F=T.useMemo(()=>d.markerStart?`url('#${zt(d.markerStart,g)}')`:void 0,[d.markerStart,g]),O=T.useMemo(()=>d.markerEnd?`url('#${zt(d.markerEnd,g)}')`:void 0,[d.markerEnd,g]);if(d.hidden||P===null||I===null||_===null||H===null)return null;const W=G=>{const{addSelectedEdges:K,unselectNodesAndEdges:ee,multiSelectionActive:ne}=M.getState();z&&(M.setState({nodesSelectionActive:!1}),d.selected&&ne?(ee({nodes:[],edges:[d]}),B.current?.blur()):K([e])),s&&s(G,d)},q=r?G=>{r(G,{...d})}:void 0,X=i?G=>{i(G,{...d})}:void 0,j=a?G=>{a(G,{...d})}:void 0,Z=f?G=>{f(G,{...d})}:void 0,Q=l?G=>{l(G,{...d})}:void 0,U=G=>{if(!E&&Un.includes(G.key)&&z){const{unselectNodesAndEdges:K,addSelectedEdges:ee}=M.getState();G.key==="Escape"?(B.current?.blur(),K({edges:[d]})):ee([e])}};return D.jsx("svg",{style:{zIndex:S},children:D.jsxs("g",{className:re(["react-flow__edge",`react-flow__edge-${N}`,d.className,w,{selected:d.selected,animated:d.animated,inactive:!z&&!s,updating:k,selectable:z}]),onClick:W,onDoubleClick:q,onContextMenu:X,onMouseEnter:j,onMouseMove:Z,onMouseLeave:Q,onKeyDown:C?U:void 0,tabIndex:C?0:void 0,role:d.ariaRole??(C?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":d.ariaLabel===null?void 0:d.ariaLabel||`Edge from ${d.source} to ${d.target}`,"aria-describedby":C?`${Do}-${g}`:void 0,ref:B,...d.domAttributes,children:[!L&&D.jsx(v,{id:e,source:d.source,target:d.target,type:d.type,selected:d.selected,animated:d.animated,selectable:z,deletable:d.deletable??!0,label:d.label,labelStyle:d.labelStyle,labelShowBg:d.labelShowBg,labelBgStyle:d.labelBgStyle,labelBgPadding:d.labelBgPadding,labelBgBorderRadius:d.labelBgBorderRadius,sourceX:P,sourceY:I,targetX:_,targetY:H,sourcePosition:V,targetPosition:R,data:d.data,style:d.style,sourceHandleId:d.sourceHandle,targetHandleId:d.targetHandle,markerStart:F,markerEnd:O,pathOptions:"pathOptions"in d?d.pathOptions:void 0,interactionWidth:d.interactionWidth}),$&&D.jsx(Ja,{edge:d,isReconnectable:$,reconnectRadius:h,onReconnect:u,onReconnectStart:c,onReconnectEnd:y,sourceX:P,sourceY:I,targetX:_,targetY:H,sourcePosition:V,targetPosition:R,setUpdateHover:A,setReconnecting:x})]})})}var tc=T.memo(ec);const nc=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function es({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:o,noPanClassName:s,onReconnect:r,onEdgeContextMenu:i,onEdgeMouseEnter:a,onEdgeMouseMove:f,onEdgeMouseLeave:l,onEdgeClick:h,reconnectRadius:u,onEdgeDoubleClick:c,onReconnectStart:y,onReconnectEnd:g,disableKeyboardA11y:b}){const{edgesFocusable:w,edgesReconnectable:p,elementsSelectable:E,onError:d}=J(nc,oe),m=Ba(t);return D.jsxs("div",{className:"react-flow__edges",children:[D.jsx(Ya,{defaultColor:e,rfId:n}),m.map(N=>D.jsx(tc,{id:N,edgesFocusable:w,edgesReconnectable:p,elementsSelectable:E,noPanClassName:s,onReconnect:r,onContextMenu:i,onMouseEnter:a,onMouseMove:f,onMouseLeave:l,onClick:h,reconnectRadius:u,onDoubleClick:c,onReconnectStart:y,onReconnectEnd:g,rfId:n,onError:d,edgeTypes:o,disableKeyboardA11y:b},N))]})}es.displayName="EdgeRenderer";const oc=T.memo(es),sc=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function rc({children:e}){const t=J(sc);return D.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function ic(e){const t=Xt(),n=T.useRef(!1);T.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const ac=e=>e.panZoom?.syncViewport;function cc(e){const t=J(ac),n=se();return T.useEffect(()=>{e&&(t?.(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function lc(e){return e.connection.inProgress?{...e.connection,to:Ke(e.connection.to,e.transform)}:{...e.connection}}function uc(e){return lc}function dc(e){const t=uc();return J(t,oe)}const fc=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function hc({containerStyle:e,style:t,type:n,component:o}){const{nodesConnectable:s,width:r,height:i,isValid:a,inProgress:f}=J(fc,oe);return!(r&&s&&f)?null:D.jsx("svg",{style:e,width:r,height:i,className:"react-flow__connectionline react-flow__container",children:D.jsx("g",{className:re(["react-flow__connection",eo(a)]),children:D.jsx(ts,{style:t,type:n,CustomComponent:o,isValid:a})})})}const ts=({style:e,type:t=ye.Bezier,CustomComponent:n,isValid:o})=>{const{inProgress:s,from:r,fromNode:i,fromHandle:a,fromPosition:f,to:l,toNode:h,toHandle:u,toPosition:c,pointer:y}=dc();if(!s)return;if(n)return D.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:a,fromX:r.x,fromY:r.y,toX:l.x,toY:l.y,fromPosition:f,toPosition:c,connectionStatus:eo(o),toNode:h,toHandle:u,pointer:y});let g="";const b={sourceX:r.x,sourceY:r.y,sourcePosition:f,targetX:l.x,targetY:l.y,targetPosition:c};switch(t){case ye.Bezier:[g]=ho(b);break;case ye.SimpleBezier:[g]=Oo(b);break;case ye.Step:[g]=_t({...b,borderRadius:0});break;case ye.SmoothStep:[g]=_t(b);break;default:[g]=po(b)}return D.jsx("path",{d:g,fill:"none",className:"react-flow__connection-path",style:e})};ts.displayName="ConnectionLine";const gc={};function Fn(e=gc){T.useRef(e),se(),T.useEffect(()=>{},[e])}function pc(){se(),T.useRef(!1),T.useEffect(()=>{},[])}function ns({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:o,onEdgeClick:s,onNodeDoubleClick:r,onEdgeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:f,onNodeMouseLeave:l,onNodeContextMenu:h,onSelectionContextMenu:u,onSelectionStart:c,onSelectionEnd:y,connectionLineType:g,connectionLineStyle:b,connectionLineComponent:w,connectionLineContainerStyle:p,selectionKeyCode:E,selectionOnDrag:d,selectionMode:m,multiSelectionKeyCode:N,panActivationKeyCode:v,zoomActivationKeyCode:C,deleteKeyCode:$,onlyRenderVisibleElements:z,elementsSelectable:B,defaultViewport:k,translateExtent:A,minZoom:L,maxZoom:x,preventScrolling:M,defaultMarkerColor:S,zoomOnScroll:P,zoomOnPinch:I,panOnScroll:_,panOnScrollSpeed:H,panOnScrollMode:V,zoomOnDoubleClick:R,panOnDrag:F,onPaneClick:O,onPaneMouseEnter:W,onPaneMouseMove:q,onPaneMouseLeave:X,onPaneScroll:j,onPaneContextMenu:Z,paneClickDistance:Q,nodeClickDistance:U,onEdgeContextMenu:G,onEdgeMouseEnter:K,onEdgeMouseMove:ee,onEdgeMouseLeave:ne,reconnectRadius:te,onReconnect:ie,onReconnectStart:ge,onReconnectEnd:fe,noDragClassName:we,noWheelClassName:Ae,noPanClassName:Te,disableKeyboardA11y:He,nodeExtent:mt,rfId:qe,viewport:Ce,onViewportChange:Le}){return Fn(e),Fn(t),pc(),ic(n),cc(Ce),D.jsx(Da,{onPaneClick:O,onPaneMouseEnter:W,onPaneMouseMove:q,onPaneMouseLeave:X,onPaneContextMenu:Z,onPaneScroll:j,paneClickDistance:Q,deleteKeyCode:$,selectionKeyCode:E,selectionOnDrag:d,selectionMode:m,onSelectionStart:c,onSelectionEnd:y,multiSelectionKeyCode:N,panActivationKeyCode:v,zoomActivationKeyCode:C,elementsSelectable:B,zoomOnScroll:P,zoomOnPinch:I,zoomOnDoubleClick:R,panOnScroll:_,panOnScrollSpeed:H,panOnScrollMode:V,panOnDrag:F,defaultViewport:k,translateExtent:A,minZoom:L,maxZoom:x,onSelectionContextMenu:u,preventScrolling:M,noDragClassName:we,noWheelClassName:Ae,noPanClassName:Te,disableKeyboardA11y:He,onViewportChange:Le,isControlledViewport:!!Ce,children:D.jsxs(rc,{children:[D.jsx(oc,{edgeTypes:t,onEdgeClick:s,onEdgeDoubleClick:i,onReconnect:ie,onReconnectStart:ge,onReconnectEnd:fe,onlyRenderVisibleElements:z,onEdgeContextMenu:G,onEdgeMouseEnter:K,onEdgeMouseMove:ee,onEdgeMouseLeave:ne,reconnectRadius:te,defaultMarkerColor:S,noPanClassName:Te,disableKeyboardA11y:He,rfId:qe}),D.jsx(hc,{style:b,type:g,component:w,containerStyle:p}),D.jsx("div",{className:"react-flow__edgelabel-renderer"}),D.jsx(Va,{nodeTypes:e,onNodeClick:o,onNodeDoubleClick:r,onNodeMouseEnter:a,onNodeMouseMove:f,onNodeMouseLeave:l,onNodeContextMenu:h,nodeClickDistance:U,onlyRenderVisibleElements:z,noPanClassName:Te,noDragClassName:we,disableKeyboardA11y:He,nodeExtent:mt,rfId:qe}),D.jsx("div",{className:"react-flow__viewport-portal"})]})})}ns.displayName="GraphView";const mc=T.memo(ns),Zn=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:s,height:r,fitView:i,fitViewOptions:a,minZoom:f=.5,maxZoom:l=2,nodeOrigin:h,nodeExtent:u,zIndexMode:c="basic"}={})=>{const y=new Map,g=new Map,b=new Map,w=new Map,p=o??t??[],E=n??e??[],d=h??[0,0],m=u??je;xo(b,w,p);const N=$t(E,y,g,{nodeOrigin:d,nodeExtent:m,zIndexMode:c});let v=[0,0,1];if(i&&s&&r){const C=We(y,{filter:k=>!!((k.width||k.initialWidth)&&(k.height||k.initialHeight))}),{x:$,y:z,zoom:B}=Vt(C,s,r,f,l,a?.padding??.1);v=[$,z,B]}return{rfId:"1",width:s??0,height:r??0,transform:v,nodes:E,nodesInitialized:N,nodeLookup:y,parentLookup:g,edges:p,edgeLookup:w,connectionLookup:b,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:o!==void 0,panZoom:null,minZoom:f,maxZoom:l,translateExtent:je,nodeExtent:m,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:De.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:d,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:i??!1,fitViewOptions:a,fitViewResolver:null,connection:{...Jn},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:$r,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:Qn,zIndexMode:c,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}},yc=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:s,height:r,fitView:i,fitViewOptions:a,minZoom:f,maxZoom:l,nodeOrigin:h,nodeExtent:u,zIndexMode:c})=>$i((y,g)=>{async function b(){const{nodeLookup:w,panZoom:p,fitViewOptions:E,fitViewResolver:d,width:m,height:N,minZoom:v,maxZoom:C}=g();p&&(await _r({nodes:w,width:m,height:N,panZoom:p,minZoom:v,maxZoom:C},E),d?.resolve(!0),y({fitViewResolver:null}))}return{...Zn({nodes:e,edges:t,width:s,height:r,fitView:i,fitViewOptions:a,minZoom:f,maxZoom:l,nodeOrigin:h,nodeExtent:u,defaultNodes:n,defaultEdges:o,zIndexMode:c}),setNodes:w=>{const{nodeLookup:p,parentLookup:E,nodeOrigin:d,elevateNodesOnSelect:m,fitViewQueued:N,zIndexMode:v}=g(),C=$t(w,p,E,{nodeOrigin:d,nodeExtent:u,elevateNodesOnSelect:m,checkEquality:!0,zIndexMode:v});N&&C?(b(),y({nodes:w,nodesInitialized:C,fitViewQueued:!1,fitViewOptions:void 0})):y({nodes:w,nodesInitialized:C})},setEdges:w=>{const{connectionLookup:p,edgeLookup:E}=g();xo(p,E,w),y({edges:w})},setDefaultNodesAndEdges:(w,p)=>{if(w){const{setNodes:E}=g();E(w),y({hasDefaultNodes:!0})}if(p){const{setEdges:E}=g();E(p),y({hasDefaultEdges:!0})}},updateNodeInternals:w=>{const{triggerNodeChanges:p,nodeLookup:E,parentLookup:d,domNode:m,nodeOrigin:N,nodeExtent:v,debug:C,fitViewQueued:$,zIndexMode:z}=g(),{changes:B,updatedInternals:k}=ti(w,E,d,m,N,v,z);k&&(Ur(E,d,{nodeOrigin:N,nodeExtent:v,zIndexMode:z}),$?(b(),y({fitViewQueued:!1,fitViewOptions:void 0})):y({}),B?.length>0&&(C&&console.log("React Flow: trigger node changes",B),p?.(B)))},updateNodePositions:(w,p=!1)=>{const E=[];let d=[];const{nodeLookup:m,triggerNodeChanges:N,connection:v,updateConnection:C,onNodesChangeMiddlewareMap:$}=g();for(const[z,B]of w){const k=m.get(z),A=!!(k?.expandParent&&k?.parentId&&B?.position),L={id:z,type:"position",position:A?{x:Math.max(0,B.position.x),y:Math.max(0,B.position.y)}:B.position,dragging:p};if(k&&v.inProgress&&v.fromNode.id===k.id){const x=Se(k,v.fromHandle,Y.Left,!0);C({...v,from:x})}A&&k.parentId&&E.push({id:z,parentId:k.parentId,rect:{...B.internals.positionAbsolute,width:B.measured.width??0,height:B.measured.height??0}}),d.push(L)}if(E.length>0){const{parentLookup:z,nodeOrigin:B}=g(),k=Yt(E,m,z,B);d.push(...k)}for(const z of $.values())d=z(d);N(d)},triggerNodeChanges:w=>{const{onNodesChange:p,setNodes:E,nodes:d,hasDefaultNodes:m,debug:N}=g();if(w?.length){if(m){const v=ea(w,d);E(v)}N&&console.log("React Flow: trigger node changes",w),p?.(w)}},triggerEdgeChanges:w=>{const{onEdgesChange:p,setEdges:E,edges:d,hasDefaultEdges:m,debug:N}=g();if(w?.length){if(m){const v=ta(w,d);E(v)}N&&console.log("React Flow: trigger edge changes",w),p?.(w)}},addSelectedNodes:w=>{const{multiSelectionActive:p,edgeLookup:E,nodeLookup:d,triggerNodeChanges:m,triggerEdgeChanges:N}=g();if(p){const v=w.map(C=>be(C,!0));m(v);return}m(Pe(d,new Set([...w]),!0)),N(Pe(E))},addSelectedEdges:w=>{const{multiSelectionActive:p,edgeLookup:E,nodeLookup:d,triggerNodeChanges:m,triggerEdgeChanges:N}=g();if(p){const v=w.map(C=>be(C,!0));N(v);return}N(Pe(E,new Set([...w]))),m(Pe(d,new Set,!0))},unselectNodesAndEdges:({nodes:w,edges:p}={})=>{const{edges:E,nodes:d,nodeLookup:m,triggerNodeChanges:N,triggerEdgeChanges:v}=g(),C=w||d,$=p||E,z=C.map(k=>{const A=m.get(k.id);return A&&(A.selected=!1),be(k.id,!1)}),B=$.map(k=>be(k.id,!1));N(z),v(B)},setMinZoom:w=>{const{panZoom:p,maxZoom:E}=g();p?.setScaleExtent([w,E]),y({minZoom:w})},setMaxZoom:w=>{const{panZoom:p,minZoom:E}=g();p?.setScaleExtent([E,w]),y({maxZoom:w})},setTranslateExtent:w=>{g().panZoom?.setTranslateExtent(w),y({translateExtent:w})},resetSelectedElements:()=>{const{edges:w,nodes:p,triggerNodeChanges:E,triggerEdgeChanges:d,elementsSelectable:m}=g();if(!m)return;const N=p.reduce((C,$)=>$.selected?[...C,be($.id,!1)]:C,[]),v=w.reduce((C,$)=>$.selected?[...C,be($.id,!1)]:C,[]);E(N),d(v)},setNodeExtent:w=>{const{nodes:p,nodeLookup:E,parentLookup:d,nodeOrigin:m,elevateNodesOnSelect:N,nodeExtent:v,zIndexMode:C}=g();w[0][0]===v[0][0]&&w[0][1]===v[0][1]&&w[1][0]===v[1][0]&&w[1][1]===v[1][1]||($t(p,E,d,{nodeOrigin:m,nodeExtent:w,elevateNodesOnSelect:N,checkEquality:!1,zIndexMode:C}),y({nodeExtent:w}))},panBy:w=>{const{transform:p,width:E,height:d,panZoom:m,translateExtent:N}=g();return ni({delta:w,panZoom:m,transform:p,translateExtent:N,width:E,height:d})},setCenter:async(w,p,E)=>{const{width:d,height:m,maxZoom:N,panZoom:v}=g();if(!v)return Promise.resolve(!1);const C=typeof E?.zoom<"u"?E.zoom:N;return await v.setViewport({x:d/2-w*C,y:m/2-p*C,zoom:C},{duration:E?.duration,ease:E?.ease,interpolate:E?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{y({connection:{...Jn}})},updateConnection:w=>{y({connection:w})},reset:()=>y({...Zn()})}},Object.is);function xc({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:o,initialWidth:s,initialHeight:r,initialMinZoom:i,initialMaxZoom:a,initialFitViewOptions:f,fitView:l,nodeOrigin:h,nodeExtent:u,zIndexMode:c,children:y}){const[g]=T.useState(()=>yc({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:s,height:r,fitView:l,minZoom:i,maxZoom:a,fitViewOptions:f,nodeOrigin:h,nodeExtent:u,zIndexMode:c}));return D.jsx(Ai,{value:g,children:D.jsx(ra,{children:y})})}function wc({children:e,nodes:t,edges:n,defaultNodes:o,defaultEdges:s,width:r,height:i,fitView:a,fitViewOptions:f,minZoom:l,maxZoom:h,nodeOrigin:u,nodeExtent:c,zIndexMode:y}){return T.useContext(ft)?D.jsx(D.Fragment,{children:e}):D.jsx(xc,{initialNodes:t,initialEdges:n,defaultNodes:o,defaultEdges:s,initialWidth:r,initialHeight:i,fitView:a,initialFitViewOptions:f,initialMinZoom:l,initialMaxZoom:h,nodeOrigin:u,nodeExtent:c,zIndexMode:y,children:e})}const bc={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function Ec({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:s,nodeTypes:r,edgeTypes:i,onNodeClick:a,onEdgeClick:f,onInit:l,onMove:h,onMoveStart:u,onMoveEnd:c,onConnect:y,onConnectStart:g,onConnectEnd:b,onClickConnectStart:w,onClickConnectEnd:p,onNodeMouseEnter:E,onNodeMouseMove:d,onNodeMouseLeave:m,onNodeContextMenu:N,onNodeDoubleClick:v,onNodeDragStart:C,onNodeDrag:$,onNodeDragStop:z,onNodesDelete:B,onEdgesDelete:k,onDelete:A,onSelectionChange:L,onSelectionDragStart:x,onSelectionDrag:M,onSelectionDragStop:S,onSelectionContextMenu:P,onSelectionStart:I,onSelectionEnd:_,onBeforeDelete:H,connectionMode:V,connectionLineType:R=ye.Bezier,connectionLineStyle:F,connectionLineComponent:O,connectionLineContainerStyle:W,deleteKeyCode:q="Backspace",selectionKeyCode:X="Shift",selectionOnDrag:j=!1,selectionMode:Z=Oe.Full,panActivationKeyCode:Q="Space",multiSelectionKeyCode:U=Ze()?"Meta":"Control",zoomActivationKeyCode:G=Ze()?"Meta":"Control",snapToGrid:K,snapGrid:ee,onlyRenderVisibleElements:ne=!1,selectNodesOnDrag:te,nodesDraggable:ie,autoPanOnNodeFocus:ge,nodesConnectable:fe,nodesFocusable:we,nodeOrigin:Ae=_o,edgesFocusable:Te,edgesReconnectable:He,elementsSelectable:mt=!0,defaultViewport:qe=Wi,minZoom:Ce=.5,maxZoom:Le=2,translateExtent:Gt=je,preventScrolling:is=!0,nodeExtent:yt,defaultMarkerColor:as="#b1b1b7",zoomOnScroll:cs=!0,zoomOnPinch:ls=!0,panOnScroll:us=!1,panOnScrollSpeed:ds=.5,panOnScrollMode:fs=Ee.Free,zoomOnDoubleClick:hs=!0,panOnDrag:gs=!0,onPaneClick:ps,onPaneMouseEnter:ms,onPaneMouseMove:ys,onPaneMouseLeave:xs,onPaneScroll:ws,onPaneContextMenu:bs,paneClickDistance:Es=1,nodeClickDistance:vs=0,children:Ss,onReconnect:Ns,onReconnectStart:Cs,onReconnectEnd:Ms,onEdgeContextMenu:Is,onEdgeDoubleClick:Ps,onEdgeMouseEnter:ks,onEdgeMouseMove:Ds,onEdgeMouseLeave:_s,reconnectRadius:zs=10,onNodesChange:$s,onEdgesChange:As,noDragClassName:Ts="nodrag",noWheelClassName:Hs="nowheel",noPanClassName:Kt="nopan",fitView:qt,fitViewOptions:Ut,connectOnClick:Ls,attributionPosition:Rs,proOptions:Vs,defaultEdgeOptions:Bs,elevateNodesOnSelect:js=!0,elevateEdgesOnSelect:Os=!1,disableKeyboardA11y:Qt=!1,autoPanOnConnect:Fs,autoPanOnNodeDrag:Zs,autoPanSpeed:Ys,connectionRadius:Xs,isValidConnection:Ws,onError:Gs,style:Ks,id:Jt,nodeDragThreshold:qs,connectionDragThreshold:Us,viewport:Qs,onViewportChange:Js,width:er,height:tr,colorMode:nr="light",debug:or,onScroll:en,ariaLabelConfig:sr,zIndexMode:tn="basic",...rr},ir){const xt=Jt||"1",ar=Ui(nr),cr=T.useCallback(nn=>{nn.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),en?.(nn)},[en]);return D.jsx("div",{"data-testid":"rf__wrapper",...rr,onScroll:cr,style:{...Ks,...bc},ref:ir,className:re(["react-flow",s,ar]),id:Jt,role:"application",children:D.jsxs(wc,{nodes:e,edges:t,width:er,height:tr,fitView:qt,fitViewOptions:Ut,minZoom:Ce,maxZoom:Le,nodeOrigin:Ae,nodeExtent:yt,zIndexMode:tn,children:[D.jsx(mc,{onInit:l,onNodeClick:a,onEdgeClick:f,onNodeMouseEnter:E,onNodeMouseMove:d,onNodeMouseLeave:m,onNodeContextMenu:N,onNodeDoubleClick:v,nodeTypes:r,edgeTypes:i,connectionLineType:R,connectionLineStyle:F,connectionLineComponent:O,connectionLineContainerStyle:W,selectionKeyCode:X,selectionOnDrag:j,selectionMode:Z,deleteKeyCode:q,multiSelectionKeyCode:U,panActivationKeyCode:Q,zoomActivationKeyCode:G,onlyRenderVisibleElements:ne,defaultViewport:qe,translateExtent:Gt,minZoom:Ce,maxZoom:Le,preventScrolling:is,zoomOnScroll:cs,zoomOnPinch:ls,zoomOnDoubleClick:hs,panOnScroll:us,panOnScrollSpeed:ds,panOnScrollMode:fs,panOnDrag:gs,onPaneClick:ps,onPaneMouseEnter:ms,onPaneMouseMove:ys,onPaneMouseLeave:xs,onPaneScroll:ws,onPaneContextMenu:bs,paneClickDistance:Es,nodeClickDistance:vs,onSelectionContextMenu:P,onSelectionStart:I,onSelectionEnd:_,onReconnect:Ns,onReconnectStart:Cs,onReconnectEnd:Ms,onEdgeContextMenu:Is,onEdgeDoubleClick:Ps,onEdgeMouseEnter:ks,onEdgeMouseMove:Ds,onEdgeMouseLeave:_s,reconnectRadius:zs,defaultMarkerColor:as,noDragClassName:Ts,noWheelClassName:Hs,noPanClassName:Kt,rfId:xt,disableKeyboardA11y:Qt,nodeExtent:yt,viewport:Qs,onViewportChange:Js}),D.jsx(qi,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:y,onConnectStart:g,onConnectEnd:b,onClickConnectStart:w,onClickConnectEnd:p,nodesDraggable:ie,autoPanOnNodeFocus:ge,nodesConnectable:fe,nodesFocusable:we,edgesFocusable:Te,edgesReconnectable:He,elementsSelectable:mt,elevateNodesOnSelect:js,elevateEdgesOnSelect:Os,minZoom:Ce,maxZoom:Le,nodeExtent:yt,onNodesChange:$s,onEdgesChange:As,snapToGrid:K,snapGrid:ee,connectionMode:V,translateExtent:Gt,connectOnClick:Ls,defaultEdgeOptions:Bs,fitView:qt,fitViewOptions:Ut,onNodesDelete:B,onEdgesDelete:k,onDelete:A,onNodeDragStart:C,onNodeDrag:$,onNodeDragStop:z,onSelectionDrag:M,onSelectionDragStart:x,onSelectionDragStop:S,onMove:h,onMoveStart:u,onMoveEnd:c,noPanClassName:Kt,nodeOrigin:Ae,rfId:xt,autoPanOnConnect:Fs,autoPanOnNodeDrag:Zs,autoPanSpeed:Ys,onError:Gs,connectionRadius:Xs,isValidConnection:Ws,selectNodesOnDrag:te,nodeDragThreshold:qs,connectionDragThreshold:Us,onBeforeDelete:H,debug:or,ariaLabelConfig:sr,zIndexMode:tn}),D.jsx(Xi,{onSelectionChange:L}),Ss,D.jsx(ji,{proOptions:Vs,position:Rs}),D.jsx(Bi,{rfId:xt,disableKeyboardA11y:Qt})]})})}var qc=$o(Ec);function vc({dimensions:e,lineWidth:t,variant:n,className:o}){return D.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:re(["react-flow__background-pattern",n,o])})}function Sc({radius:e,className:t}){return D.jsx("circle",{cx:e,cy:e,r:e,className:re(["react-flow__background-pattern","dots",t])})}var xe;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(xe||(xe={}));const Nc={[xe.Dots]:1,[xe.Lines]:1,[xe.Cross]:6},Cc=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function os({id:e,variant:t=xe.Dots,gap:n=20,size:o,lineWidth:s=1,offset:r=0,color:i,bgColor:a,style:f,className:l,patternClassName:h}){const u=T.useRef(null),{transform:c,patternId:y}=J(Cc,oe),g=o||Nc[t],b=t===xe.Dots,w=t===xe.Cross,p=Array.isArray(n)?n:[n,n],E=[p[0]*c[2]||1,p[1]*c[2]||1],d=g*c[2],m=Array.isArray(r)?r:[r,r],N=w?[d,d]:E,v=[m[0]*c[2]||1+N[0]/2,m[1]*c[2]||1+N[1]/2],C=`${y}${e||""}`;return D.jsxs("svg",{className:re(["react-flow__background",l]),style:{...f,...gt,"--xy-background-color-props":a,"--xy-background-pattern-color-props":i},ref:u,"data-testid":"rf__background",children:[D.jsx("pattern",{id:C,x:c[0]%E[0],y:c[1]%E[1],width:E[0],height:E[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${v[0]},-${v[1]})`,children:b?D.jsx(Sc,{radius:d/2,className:h}):D.jsx(vc,{dimensions:N,lineWidth:s,variant:t,className:h})}),D.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${C})`})]})}os.displayName="Background";const Uc=T.memo(os);function Mc(){return D.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:D.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Ic(){return D.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:D.jsx("path",{d:"M0 0h32v4.2H0z"})})}function Pc(){return D.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:D.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function kc(){return D.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:D.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Dc(){return D.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:D.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function nt({children:e,className:t,...n}){return D.jsx("button",{type:"button",className:re(["react-flow__controls-button",t]),...n,children:e})}const _c=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function ss({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:s,onZoomIn:r,onZoomOut:i,onFitView:a,onInteractiveChange:f,className:l,children:h,position:u="bottom-left",orientation:c="vertical","aria-label":y}){const g=se(),{isInteractive:b,minZoomReached:w,maxZoomReached:p,ariaLabelConfig:E}=J(_c,oe),{zoomIn:d,zoomOut:m,fitView:N}=Xt(),v=()=>{d(),r?.()},C=()=>{m(),i?.()},$=()=>{N(s),a?.()},z=()=>{g.setState({nodesDraggable:!b,nodesConnectable:!b,elementsSelectable:!b}),f?.(!b)},B=c==="horizontal"?"horizontal":"vertical";return D.jsxs(ht,{className:re(["react-flow__controls",B,l]),position:u,style:e,"data-testid":"rf__controls","aria-label":y??E["controls.ariaLabel"],children:[t&&D.jsxs(D.Fragment,{children:[D.jsx(nt,{onClick:v,className:"react-flow__controls-zoomin",title:E["controls.zoomIn.ariaLabel"],"aria-label":E["controls.zoomIn.ariaLabel"],disabled:p,children:D.jsx(Mc,{})}),D.jsx(nt,{onClick:C,className:"react-flow__controls-zoomout",title:E["controls.zoomOut.ariaLabel"],"aria-label":E["controls.zoomOut.ariaLabel"],disabled:w,children:D.jsx(Ic,{})})]}),n&&D.jsx(nt,{className:"react-flow__controls-fitview",onClick:$,title:E["controls.fitView.ariaLabel"],"aria-label":E["controls.fitView.ariaLabel"],children:D.jsx(Pc,{})}),o&&D.jsx(nt,{className:"react-flow__controls-interactive",onClick:z,title:E["controls.interactive.ariaLabel"],"aria-label":E["controls.interactive.ariaLabel"],children:b?D.jsx(Dc,{}):D.jsx(kc,{})}),h]})}ss.displayName="Controls";T.memo(ss);function zc({id:e,x:t,y:n,width:o,height:s,style:r,color:i,strokeColor:a,strokeWidth:f,className:l,borderRadius:h,shapeRendering:u,selected:c,onClick:y}){const{background:g,backgroundColor:b}=r||{},w=i||g||b;return D.jsx("rect",{className:re(["react-flow__minimap-node",{selected:c},l]),x:t,y:n,rx:h,ry:h,width:o,height:s,style:{fill:w,stroke:a,strokeWidth:f},shapeRendering:u,onClick:y?p=>y(p,e):void 0})}const $c=T.memo(zc),Ac=e=>e.nodes.map(t=>t.id),Pt=e=>e instanceof Function?e:()=>e;function Tc({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:o=5,nodeStrokeWidth:s,nodeComponent:r=$c,onClick:i}){const a=J(Ac,oe),f=Pt(t),l=Pt(e),h=Pt(n),u=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return D.jsx(D.Fragment,{children:a.map(c=>D.jsx(Lc,{id:c,nodeColorFunc:f,nodeStrokeColorFunc:l,nodeClassNameFunc:h,nodeBorderRadius:o,nodeStrokeWidth:s,NodeComponent:r,onClick:i,shapeRendering:u},c))})}function Hc({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:o,nodeBorderRadius:s,nodeStrokeWidth:r,shapeRendering:i,NodeComponent:a,onClick:f}){const{node:l,x:h,y:u,width:c,height:y}=J(g=>{const{internals:b}=g.nodeLookup.get(e),w=b.userNode,{x:p,y:E}=b.positionAbsolute,{width:d,height:m}=he(w);return{node:w,x:p,y:E,width:d,height:m}},oe);return!l||l.hidden||!io(l)?null:D.jsx(a,{x:h,y:u,width:c,height:y,style:l.style,selected:!!l.selected,className:o(l),color:t(l),borderRadius:s,strokeColor:n(l),strokeWidth:r,shapeRendering:i,onClick:f,id:l.id})}const Lc=T.memo(Hc);var Rc=T.memo(Tc);const Vc=200,Bc=150,jc=e=>!e.hidden,Oc=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?ro(We(e.nodeLookup,{filter:jc}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},Fc="react-flow__minimap-desc";function rs({style:e,className:t,nodeStrokeColor:n,nodeColor:o,nodeClassName:s="",nodeBorderRadius:r=5,nodeStrokeWidth:i,nodeComponent:a,bgColor:f,maskColor:l,maskStrokeColor:h,maskStrokeWidth:u,position:c="bottom-right",onClick:y,onNodeClick:g,pannable:b=!1,zoomable:w=!1,ariaLabel:p,inversePan:E,zoomStep:d=1,offsetScale:m=5}){const N=se(),v=T.useRef(null),{boundingRect:C,viewBB:$,rfId:z,panZoom:B,translateExtent:k,flowWidth:A,flowHeight:L,ariaLabelConfig:x}=J(Oc,oe),M=e?.width??Vc,S=e?.height??Bc,P=C.width/M,I=C.height/S,_=Math.max(P,I),H=_*M,V=_*S,R=m*_,F=C.x-(H-C.width)/2-R,O=C.y-(V-C.height)/2-R,W=H+R*2,q=V+R*2,X=`${Fc}-${z}`,j=T.useRef(0),Z=T.useRef();j.current=_,T.useEffect(()=>{if(v.current&&B)return Z.current=di({domNode:v.current,panZoom:B,getTransform:()=>N.getState().transform,getViewScale:()=>j.current}),()=>{Z.current?.destroy()}},[B]),T.useEffect(()=>{Z.current?.update({translateExtent:k,width:A,height:L,inversePan:E,pannable:b,zoomStep:d,zoomable:w})},[b,w,E,d,k,A,L]);const Q=y?K=>{const[ee,ne]=Z.current?.pointer(K)||[0,0];y(K,{x:ee,y:ne})}:void 0,U=g?T.useCallback((K,ee)=>{const ne=N.getState().nodeLookup.get(ee).internals.userNode;g(K,ne)},[]):void 0,G=p??x["minimap.ariaLabel"];return D.jsx(ht,{position:c,style:{...e,"--xy-minimap-background-color-props":typeof f=="string"?f:void 0,"--xy-minimap-mask-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-stroke-color-props":typeof h=="string"?h:void 0,"--xy-minimap-mask-stroke-width-props":typeof u=="number"?u*_:void 0,"--xy-minimap-node-background-color-props":typeof o=="string"?o:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="number"?i:void 0},className:re(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:D.jsxs("svg",{width:M,height:S,viewBox:`${F} ${O} ${W} ${q}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":X,ref:v,onClick:Q,children:[G&&D.jsx("title",{id:X,children:G}),D.jsx(Rc,{onClick:U,nodeColor:o,nodeStrokeColor:n,nodeBorderRadius:r,nodeClassName:s,nodeStrokeWidth:i,nodeComponent:a}),D.jsx("path",{className:"react-flow__minimap-mask",d:`M${F-R},${O-R}h${W+R*2}v${q+R*2}h${-W-R*2}z
        M${$.x},${$.y}h${$.width}v${$.height}h${-$.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}rs.displayName="MiniMap";const Qc=T.memo(rs),Zc=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,Yc={[Ne.Line]:"right",[Ne.Handle]:"bottom-right"};function Xc({nodeId:e,position:t,variant:n=Ne.Handle,className:o,style:s=void 0,children:r,color:i,minWidth:a=10,minHeight:f=10,maxWidth:l=Number.MAX_VALUE,maxHeight:h=Number.MAX_VALUE,keepAspectRatio:u=!1,resizeDirection:c,autoScale:y=!0,shouldResize:g,onResizeStart:b,onResize:w,onResizeEnd:p}){const E=Lo(),d=typeof e=="string"?e:E,m=se(),N=T.useRef(null),v=n===Ne.Handle,C=J(T.useCallback(Zc(v&&y),[v,y]),oe),$=T.useRef(null),z=t??Yc[n];T.useEffect(()=>{if(!(!N.current||!d))return $.current||($.current=Ii({domNode:N.current,nodeId:d,getStoreItems:()=>{const{nodeLookup:k,transform:A,snapGrid:L,snapToGrid:x,nodeOrigin:M,domNode:S}=m.getState();return{nodeLookup:k,transform:A,snapGrid:L,snapToGrid:x,nodeOrigin:M,paneDomNode:S}},onChange:(k,A)=>{const{triggerNodeChanges:L,nodeLookup:x,parentLookup:M,nodeOrigin:S}=m.getState(),P=[],I={x:k.x,y:k.y},_=x.get(d);if(_&&_.expandParent&&_.parentId){const H=_.origin??S,V=k.width??_.measured.width??0,R=k.height??_.measured.height??0,F={id:_.id,parentId:_.parentId,rect:{width:V,height:R,...ao({x:k.x??_.position.x,y:k.y??_.position.y},{width:V,height:R},_.parentId,x,H)}},O=Yt([F],x,M,S);P.push(...O),I.x=k.x?Math.max(H[0]*V,k.x):void 0,I.y=k.y?Math.max(H[1]*R,k.y):void 0}if(I.x!==void 0&&I.y!==void 0){const H={id:d,type:"position",position:{...I}};P.push(H)}if(k.width!==void 0&&k.height!==void 0){const V={id:d,type:"dimensions",resizing:!0,setAttributes:c?c==="horizontal"?"width":"height":!0,dimensions:{width:k.width,height:k.height}};P.push(V)}for(const H of A){const V={...H,type:"position"};P.push(V)}L(P)},onEnd:({width:k,height:A})=>{const L={id:d,type:"dimensions",resizing:!1,dimensions:{width:k,height:A}};m.getState().triggerNodeChanges([L])}})),$.current.update({controlPosition:z,boundaries:{minWidth:a,minHeight:f,maxWidth:l,maxHeight:h},keepAspectRatio:u,resizeDirection:c,onResizeStart:b,onResize:w,onResizeEnd:p,shouldResize:g}),()=>{$.current?.destroy()}},[z,a,f,l,h,u,b,w,p,g]);const B=z.split("-");return D.jsx("div",{className:re(["react-flow__resize-control","nodrag",...B,n,o]),ref:N,style:{...s,scale:C,...i&&{[v?"backgroundColor":"borderColor"]:i}},children:r})}const Yn=T.memo(Xc);function Jc({nodeId:e,isVisible:t=!0,handleClassName:n,handleStyle:o,lineClassName:s,lineStyle:r,color:i,minWidth:a=10,minHeight:f=10,maxWidth:l=Number.MAX_VALUE,maxHeight:h=Number.MAX_VALUE,keepAspectRatio:u=!1,autoScale:c=!0,shouldResize:y,onResizeStart:g,onResize:b,onResizeEnd:w}){return t?D.jsxs(D.Fragment,{children:[Ei.map(p=>D.jsx(Yn,{className:s,style:r,nodeId:e,position:p,variant:Ne.Line,color:i,minWidth:a,minHeight:f,maxWidth:l,maxHeight:h,onResizeStart:g,keepAspectRatio:u,autoScale:c,shouldResize:y,onResize:b,onResizeEnd:w},p)),bi.map(p=>D.jsx(Yn,{className:n,style:o,nodeId:e,position:p,color:i,minWidth:a,minHeight:f,maxWidth:l,maxHeight:h,onResizeStart:g,keepAspectRatio:u,autoScale:c,shouldResize:y,onResize:b,onResizeEnd:w},p))]}):null}function el(e,t){T.useEffect(()=>{function n(o){(o.metaKey||o.ctrlKey)&&(o.key==="z"&&!o.shiftKey?(o.preventDefault(),e()):(o.key==="z"&&o.shiftKey||o.key==="y")&&(o.preventDefault(),t()))}return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[e,t])}export{Uc as B,at as H,st as M,Jc as N,Y as P,xc as R,Fr as a,ta as b,ea as c,xe as d,el as e,Qc as f,qc as i,Xt as u};
