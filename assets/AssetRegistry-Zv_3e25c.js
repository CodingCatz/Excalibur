const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CharacterArtMetaEditor-BDI2UthJ.js","assets/index-BO31ZqPg.js","assets/index-DKWk5wku.css","assets/MetaField-Bml9FA2m.js","assets/SectionHeader-CACnNDne.js","assets/StringArrayEditor-BCoMBoiZ.js","assets/AssetSpecSection-DFRZOVT7.js","assets/ArtDirectionSection-BSAEd1f0.js","assets/EnvironmentArtMetaEditor-64YyeepJ.js","assets/ObjectArrayEditor-3lw9ARiJ.js","assets/UiArtMetaEditor-DGfg8K4A.js","assets/IconMetaEditor-DO1e-kvh.js","assets/AnimationMetaEditor-Od4w-uZH.js","assets/VfxMetaEditor-DYc1xldg.js","assets/PerformanceSection-DhNGFtvN.js","assets/BgmMetaEditor-C00wmYEk.js","assets/AudioSpecSection-BdWILS6Z.js","assets/SfxMetaEditor-fft7D7ux.js","assets/VoiceMetaEditor-3vZPV4yZ.js","assets/VideoMetaEditor-CSnmwJvw.js","assets/FontMetaEditor-C8XcM47G.js","assets/PrefabMetaEditor-BUnQLOrN.js","assets/GenericMetaEditor-L7dqlhWz.js"])))=>i.map(i=>d[i]);
import{c as z,aZ as be,a_ as ne,aB as E,bL as pe,r as m,j as e,c0 as Ce,c1 as oe,aD as S,B as y,bN as Ne,b5 as f,aC as R,X as D,I as ie,bQ as L,ar as P,c2 as _e,bR as Ae,b$ as ke,aF as we,aH as Ee,bV as Te,c3 as Se,c4 as ze,bW as le,aM as Ie,bX as Me,b6 as B,a$ as A,b0 as k,b7 as G,b1 as w,b8 as J,ba as b,bb as M}from"./index-BO31ZqPg.js";import{P as De,a as Le,b as Pe}from"./useReadmeHelp-Dp5zdwnQ.js";import{u as Re,I as Oe,T as $e}from"./useAutoSave-CfhZAdWB.js";import{T as Ve,M as Fe}from"./type-CgJifwFr.js";import{T as Ue}from"./tag-D7WN3Vb4.js";import{C as Be}from"./copy-Nwklh3jE.js";import{T as Ge}from"./ToolbarSearch-CLAh0rai.js";import{F as Je,C as Ye}from"./funnel-CqB9476H.js";import{U as qe}from"./user-BWss316X.js";import{C as He}from"./chart-column-DBcOFAjW.js";import{S as Xe}from"./settings-G-zrdoVy.js";const Ze=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],Qe=z("box",Ze);const We=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]],ce=z("film",We);const Ke=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],es=z("mic",Ke);const ss=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],de=z("music",ss);const ts=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],me=z("sparkles",ts),h=be()((t,c)=>({assets:[],customCategories:[],assignees:[],filterCategory:"all",filterStatus:"all",filterAssignee:"all",filterSearch:"",setAssets:s=>t({assets:s}),addAsset:s=>{const a=Date.now(),l={id:ne(),name:"",category:"other",status:"planned",priority:"medium",tags:[],createdAt:a,updatedAt:a,metadata:{type:"generic"},...s};return t(u=>({assets:[...u.assets,l]})),l},updateAsset:(s,a)=>t(l=>({assets:l.assets.map(u=>u.id===s?{...u,...a,updatedAt:Date.now()}:u)})),removeAsset:s=>t(a=>({assets:a.assets.filter(l=>l.id!==s)})),duplicateAsset:s=>{const a=c().assets.find(g=>g.id===s);if(!a)return;const l=Date.now(),u={...a,id:ne(),name:`${a.name} (copy)`,createdAt:l,updatedAt:l};t(g=>{const i=g.assets.findIndex(x=>x.id===s),o=[...g.assets];return o.splice(i+1,0,u),{assets:o}})},addCustomCategory:s=>t(a=>a.customCategories.includes(s)?a:{customCategories:[...a.customCategories,s]}),removeCustomCategory:s=>t(a=>({customCategories:a.customCategories.filter(l=>l!==s)})),addAssignee:s=>t(a=>a.assignees.includes(s)?a:{assignees:[...a.assignees,s]}),removeAssignee:s=>t(a=>({assignees:a.assignees.filter(l=>l!==s)})),setFilterCategory:s=>t({filterCategory:s}),setFilterStatus:s=>t({filterStatus:s}),setFilterAssignee:s=>t({filterAssignee:s}),setFilterSearch:s=>t({filterSearch:s}),load:(s,a,l)=>t({assets:s,customCategories:a??[],assignees:l??[]}),reset:()=>t({assets:[],customCategories:[],assignees:[],filterCategory:"all",filterStatus:"all",filterAssignee:"all",filterSearch:""})}));function as(){const{assets:t,filterCategory:c,filterStatus:s,filterAssignee:a,filterSearch:l}=h();return t.filter(u=>{if(c!=="all"&&u.category!==c||s!=="all"&&u.status!==s||a!=="all"&&(a==="__none__"?u.assignee:u.assignee!==a))return!1;if(l){const g=l.toLowerCase(),i=u.name.toLowerCase().includes(g),o=u.id.toLowerCase().includes(g),x=u.tags.some(v=>v.toLowerCase().includes(g)),r=u.assignee?.toLowerCase().includes(g);if(!i&&!o&&!x&&!r)return!1}return!0})}const rs=new Set(["character-art","environment-art","ui-art","icon","animation","vfx","bgm","sfx","voice","video","font","prefab","other"]),ns={"character-art":oe,"environment-art":oe,"ui-art":Fe,icon:me,animation:ce,vfx:me,bgm:de,sfx:de,voice:es,video:ce,font:Ve,prefab:Qe,other:Ce},os={planned:"bg-muted text-muted-foreground","in-progress":"bg-blue-500/15 text-blue-700 dark:text-blue-400",review:"bg-yellow-500/15 text-yellow-700 dark:text-yellow-400",approved:"bg-green-500/15 text-green-700 dark:text-green-400",integrated:"bg-purple-500/15 text-purple-700 dark:text-purple-400",deprecated:"bg-red-500/15 text-red-700 dark:text-red-400"},is={high:"bg-red-500",medium:"bg-yellow-500",low:"bg-green-500"};function ls({selectedId:t,onSelect:c}){const s=E(),a=pe(),{removeAsset:l,duplicateAsset:u}=h(),g=as(),i=m.useCallback(async o=>{await a({title:s("asset.deleteConfirm"),variant:"destructive"})&&l(o)},[a,l,s]);return e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"flex-1 overflow-y-auto",children:g.length===0?e.jsx("p",{className:"py-12 text-center text-sm text-muted-foreground",children:s("asset.empty")}):e.jsx("div",{className:"divide-y",children:g.map(o=>{const x=ns[o.category]??Ue;return e.jsxs("div",{className:`group flex cursor-pointer items-center gap-2 px-3 py-2 text-sm transition-colors hover:bg-accent/50 ${t===o.id?"bg-accent":""}`,onClick:()=>c(o.id),children:[e.jsx(x,{className:"size-4 shrink-0 text-muted-foreground"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:`size-2 rounded-full ${is[o.priority]}`}),e.jsx("span",{className:"truncate font-medium",children:o.name||s("asset.untitled")})]}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-0.5",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:rs.has(o.category)?s(`asset.cat.${o.category}`):o.category}),o.tags.slice(0,2).map(r=>e.jsx(S,{variant:"secondary",className:"h-4 px-1 text-[10px]",children:r},r))]})]}),e.jsx(S,{className:`shrink-0 text-[10px] ${os[o.status]}`,variant:"secondary",children:s(`asset.status.${o.status}`)}),e.jsxs("div",{className:"flex shrink-0 gap-0.5 md:opacity-0 md:group-hover:opacity-100",children:[e.jsx(y,{variant:"ghost",size:"icon",className:"size-6",onClick:r=>{r.stopPropagation(),u(o.id)},children:e.jsx(Be,{className:"size-3"})}),e.jsx(y,{variant:"ghost",size:"icon",className:"size-6",onClick:r=>{r.stopPropagation(),i(o.id)},children:e.jsx(Ne,{className:"size-3"})})]})]},o.id)})})}),e.jsxs("div",{className:"border-t px-3 py-1.5 text-xs text-muted-foreground",children:[g.length," ",s("asset.items")]})]})}const cs=m.lazy(()=>f(()=>import("./CharacterArtMetaEditor-BDI2UthJ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),ds=m.lazy(()=>f(()=>import("./EnvironmentArtMetaEditor-64YyeepJ.js"),__vite__mapDeps([8,1,2,3,4,5,9,6,7]))),ms=m.lazy(()=>f(()=>import("./UiArtMetaEditor-DGfg8K4A.js"),__vite__mapDeps([10,1,2,3,4,5,6,7]))),us=m.lazy(()=>f(()=>import("./IconMetaEditor-DO1e-kvh.js"),__vite__mapDeps([11,1,2,3,4,5,6,7]))),xs=m.lazy(()=>f(()=>import("./AnimationMetaEditor-Od4w-uZH.js"),__vite__mapDeps([12,1,2,3,4,5,9]))),gs=m.lazy(()=>f(()=>import("./VfxMetaEditor-DYc1xldg.js"),__vite__mapDeps([13,1,2,3,4,5,6,14]))),hs=m.lazy(()=>f(()=>import("./BgmMetaEditor-C00wmYEk.js"),__vite__mapDeps([15,1,2,3,4,5,9,16]))),ps=m.lazy(()=>f(()=>import("./SfxMetaEditor-fft7D7ux.js"),__vite__mapDeps([17,1,2,3,4,5,16]))),fs=m.lazy(()=>f(()=>import("./VoiceMetaEditor-3vZPV4yZ.js"),__vite__mapDeps([18,1,2,3,4,16]))),js=m.lazy(()=>f(()=>import("./VideoMetaEditor-CSnmwJvw.js"),__vite__mapDeps([19,1,2,3,4,5,9]))),ys=m.lazy(()=>f(()=>import("./FontMetaEditor-C8XcM47G.js"),__vite__mapDeps([20,1,2,3,4,5]))),vs=m.lazy(()=>f(()=>import("./PrefabMetaEditor-BUnQLOrN.js"),__vite__mapDeps([21,1,2,3,4,5,14]))),bs=m.lazy(()=>f(()=>import("./GenericMetaEditor-L7dqlhWz.js"),__vite__mapDeps([22,1,2,4])));function Cs({asset:t,onMetadataChange:c}){const s=t.metadata;return e.jsxs(m.Suspense,{fallback:null,children:[s.type==="character-art"&&e.jsx(cs,{meta:s,onChange:c}),s.type==="environment-art"&&e.jsx(ds,{meta:s,onChange:c}),s.type==="ui-art"&&e.jsx(ms,{meta:s,onChange:c}),s.type==="icon"&&e.jsx(us,{meta:s,onChange:c}),s.type==="animation"&&e.jsx(xs,{meta:s,onChange:c}),s.type==="vfx"&&e.jsx(gs,{meta:s,onChange:c}),s.type==="bgm"&&e.jsx(hs,{meta:s,onChange:c}),s.type==="sfx"&&e.jsx(ps,{meta:s,onChange:c}),s.type==="voice"&&e.jsx(fs,{meta:s,onChange:c}),s.type==="video"&&e.jsx(js,{meta:s,onChange:c}),s.type==="font"&&e.jsx(ys,{meta:s,onChange:c}),s.type==="prefab"&&e.jsx(vs,{meta:s,onChange:c}),s.type==="generic"&&e.jsx(bs,{meta:s,onChange:c})]})}const Ns={"character-art":"character-art","environment-art":"environment-art","ui-art":"ui-art",icon:"icon",animation:"animation",vfx:"vfx",bgm:"bgm",sfx:"sfx",voice:"voice",video:"video",font:"font",prefab:"prefab",other:"generic"};function ue(t){switch(Ns[t]??"generic"){case"character-art":return{type:"character-art",variants:[]};case"environment-art":return{type:"environment-art"};case"ui-art":return{type:"ui-art"};case"icon":return{type:"icon"};case"animation":return{type:"animation"};case"vfx":return{type:"vfx"};case"bgm":return{type:"bgm"};case"sfx":return{type:"sfx"};case"voice":return{type:"voice"};case"video":return{type:"video"};case"font":return{type:"font"};case"prefab":return{type:"prefab"};default:return{type:"generic"}}}const _s=["character-art","environment-art","ui-art","icon","animation","vfx","bgm","sfx","voice","video","font","prefab","other"],As=["planned","in-progress","review","approved","integrated","deprecated"],ks=["high","medium","low"],xe="__add__",ge="__add__";function ws({assetId:t,onClose:c}){const s=E(),a=R(),l=h(n=>n.assets.find(p=>p.id===t)),u=h(n=>n.updateAsset),g=h(n=>n.customCategories),i=h(n=>n.assignees),o=h(n=>n.addCustomCategory),x=h(n=>n.addAssignee),r=m.useCallback(n=>u(t,n),[t,u]),v=m.useCallback(async n=>{if(n===xe){const p=await a({title:s("asset.addCategory"),placeholder:s("asset.addCategory")});if(!p)return;o(p),r({category:p,metadata:ue(p)})}else r({category:n,metadata:ue(n)})},[a,s,o,r]),N=m.useCallback(async n=>{if(n===ge){const p=await a({title:s("asset.addAssignee"),placeholder:s("asset.addAssignee")});if(!p)return;x(p),r({assignee:p})}else r({assignee:n||void 0})},[a,s,x,r]);return l?e.jsxs("div",{className:"max-h-[50vh] shrink-0 overflow-y-auto border-b",children:[e.jsxs("div",{className:"flex items-center justify-between border-b px-3 py-2",children:[e.jsx("span",{className:"text-sm font-medium",children:s("asset.details")}),e.jsx(y,{variant:"ghost",size:"icon",className:"size-6",onClick:c,children:e.jsx(D,{className:"size-3.5"})})]}),e.jsx("div",{className:"p-3",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[e.jsx(C,{label:s("asset.name"),children:e.jsx(ie,{className:"h-8 text-sm",value:l.name,onChange:n=>r({name:n.target.value})})}),e.jsx(C,{label:s("asset.category"),children:e.jsxs("select",{className:"h-8 w-full rounded-md border bg-background px-2 text-sm",value:l.category,onChange:n=>v(n.target.value),children:[_s.map(n=>e.jsx("option",{value:n,children:s(`asset.cat.${n}`)},n)),g.length>0&&e.jsx("optgroup",{label:s("asset.customCategories"),children:g.map(n=>e.jsx("option",{value:n,children:n},n))}),e.jsxs("option",{value:xe,children:["＋ ",s("asset.addCategory")]})]})}),e.jsx(C,{label:s("asset.statusLabel"),children:e.jsx("select",{className:"h-8 w-full rounded-md border bg-background px-2 text-sm",value:l.status,onChange:n=>r({status:n.target.value}),children:As.map(n=>e.jsx("option",{value:n,children:s(`asset.status.${n}`)},n))})}),e.jsx(C,{label:s("asset.priority"),children:e.jsx("select",{className:"h-8 w-full rounded-md border bg-background px-2 text-sm",value:l.priority,onChange:n=>r({priority:n.target.value}),children:ks.map(n=>e.jsx("option",{value:n,children:s(`asset.priority.${n}`)},n))})}),e.jsx(C,{label:s("asset.assignee"),children:e.jsxs("select",{className:"h-8 w-full rounded-md border bg-background px-2 text-sm",value:l.assignee??"",onChange:n=>N(n.target.value),children:[e.jsx("option",{value:"",children:s("asset.noAssignee")}),i.map(n=>e.jsx("option",{value:n,children:n},n)),e.jsxs("option",{value:ge,children:["＋ ",s("asset.addAssignee")]})]})}),e.jsx(C,{label:s("asset.filePath"),children:e.jsx(ie,{className:"h-8 text-sm",value:l.filePath??"",onChange:n=>r({filePath:n.target.value||void 0}),placeholder:"assets/sprites/hero.png"})}),e.jsx("div",{className:"col-span-full",children:e.jsx(C,{label:s("asset.tags"),children:e.jsx(Es,{tags:l.tags,onChange:n=>r({tags:n})})})}),e.jsx("div",{className:"col-span-full",children:e.jsx(C,{label:s("asset.notes"),children:e.jsx("textarea",{className:"w-full rounded-md border bg-background px-2 py-1.5 text-sm resize-none",rows:2,value:l.notes??"",onChange:n=>r({notes:n.target.value||void 0})})})}),e.jsxs("div",{className:"col-span-full flex gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:[s("asset.created"),": ",new Date(l.createdAt).toLocaleString()]}),e.jsxs("span",{children:[s("asset.updated"),": ",new Date(l.updatedAt).toLocaleString()]})]}),e.jsxs("div",{className:"col-span-full",children:[e.jsx(L,{className:"my-1"}),e.jsx(Cs,{asset:l,onMetadataChange:m.useCallback(n=>r({metadata:n}),[r])})]})]})})]}):null}function C({label:t,children:c}){return e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-medium text-muted-foreground",children:t}),c]})}function Es({tags:t,onChange:c}){const s=R(),a=E(),l=m.useCallback(async()=>{const u=await s({title:a("asset.addTag"),placeholder:"Tag"});u&&!t.includes(u)&&c([...t,u])},[t,c,s,a]);return e.jsxs("div",{className:"flex flex-wrap gap-1",children:[t.map(u=>e.jsxs(S,{variant:"secondary",className:"gap-0.5 pr-1",children:[u,e.jsx("button",{className:"ml-0.5 rounded-full hover:bg-muted",onClick:()=>c(t.filter(g=>g!==u)),children:e.jsx(D,{className:"size-2.5"})})]},u)),e.jsx(y,{variant:"ghost",size:"sm",className:"h-5 px-1 text-xs",onClick:l,children:e.jsx(P,{className:"size-3"})})]})}function Ts(){const t=E(),c=R(),s=h(r=>r.customCategories),a=h(r=>r.assignees),l=h(r=>r.addCustomCategory),u=h(r=>r.removeCustomCategory),g=h(r=>r.addAssignee),i=h(r=>r.removeAssignee),o=m.useCallback(async()=>{const r=await c({title:t("asset.addCategory"),placeholder:t("asset.addCategory")});r&&l(r)},[c,t,l]),x=m.useCallback(async()=>{const r=await c({title:t("asset.addAssignee"),placeholder:t("asset.addAssignee")});r&&g(r)},[c,t,g]);return e.jsxs("div",{className:"flex flex-col gap-3 p-3 w-64",children:[e.jsx("span",{className:"text-sm font-medium",children:t("asset.settings")}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-xs font-medium text-muted-foreground",children:t("asset.customCategories")}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.map(r=>e.jsxs(S,{variant:"secondary",className:"gap-0.5 pr-1",children:[r,e.jsx("button",{className:"ml-0.5 rounded-full hover:bg-muted",onClick:()=>u(r),children:e.jsx(D,{className:"size-2.5"})})]},r)),e.jsx(y,{variant:"ghost",size:"sm",className:"h-5 px-1 text-xs",onClick:o,children:e.jsx(P,{className:"size-3"})})]}),s.length===0&&e.jsx("p",{className:"text-xs text-muted-foreground",children:t("asset.noCustomCategories")})]}),e.jsx(L,{}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-xs font-medium text-muted-foreground",children:t("asset.teamMembers")}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.map(r=>e.jsxs(S,{variant:"secondary",className:"gap-0.5 pr-1",children:[r,e.jsx("button",{className:"ml-0.5 rounded-full hover:bg-muted",onClick:()=>i(r),children:e.jsx(D,{className:"size-2.5"})})]},r)),e.jsx(y,{variant:"ghost",size:"sm",className:"h-5 px-1 text-xs",onClick:x,children:e.jsx(P,{className:"size-3"})})]}),a.length===0&&e.jsx("p",{className:"text-xs text-muted-foreground",children:t("asset.noTeamMembers")})]})]})}const he=["character-art","environment-art","ui-art","icon","animation","vfx","bgm","sfx","voice","video","font","prefab","other"],Ss={planned:"bg-slate-400","in-progress":"bg-blue-500",review:"bg-yellow-500",approved:"bg-green-500",integrated:"bg-emerald-600",deprecated:"bg-red-400"},zs={high:"bg-red-500",medium:"bg-yellow-500",low:"bg-slate-400"};function Is(){const t=E(),{assets:c,customCategories:s}=h(),a=m.useMemo(()=>{const i=c.length,o=new Map,x=new Map,r=new Map,v=new Map;for(const j of c){o.set(j.status,(o.get(j.status)??0)+1),x.set(j.category,(x.get(j.category)??0)+1),v.set(j.priority,(v.get(j.priority)??0)+1);const T=j.assignee||"__none__",_=r.get(T)??{total:0,done:0};_.total++,(j.status==="approved"||j.status==="integrated")&&_.done++,r.set(T,_)}const N=(o.get("approved")??0)+(o.get("integrated")??0),n=o.get("in-progress")??0,p=i>0?Math.round(N/i*100):0;return{total:i,completed:N,inProgress:n,progress:p,byStatus:o,byCategory:x,byAssignee:r,byPriority:v}},[c]),l=m.useMemo(()=>[...he,...s].map(o=>({category:o,count:a.byCategory.get(o)??0})).filter(o=>o.count>0).sort((o,x)=>x.count-o.count),[a.byCategory,s]),u=m.useMemo(()=>new Set(he),[]);if(c.length===0)return e.jsx("div",{className:"border-b p-3 text-sm text-muted-foreground",children:t("asset.dashboard.empty")});const g=l.length>0?l[0].count:1;return e.jsxs("div",{className:"shrink-0 space-y-3 border-b p-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(_e,{className:"size-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:a.total}),e.jsx("span",{className:"text-muted-foreground",children:t("asset.dashboard.total")})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-green-600 dark:text-green-500",children:[e.jsx(Ae,{className:"size-4"}),e.jsx("span",{className:"font-medium",children:a.completed})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-blue-600 dark:text-blue-400",children:[e.jsx(ke,{className:"size-4"}),e.jsx("span",{className:"font-medium",children:a.inProgress})]}),e.jsxs("div",{className:"ml-auto flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx("span",{children:t("asset.dashboard.progress")}),e.jsx("div",{className:"h-2 w-32 overflow-hidden rounded-full bg-muted",children:e.jsx("div",{className:`h-full rounded-full transition-all ${a.progress===100?"bg-green-500":a.progress>=60?"bg-blue-500":a.progress>=30?"bg-yellow-500":"bg-red-500"}`,style:{width:`${a.progress}%`}})}),e.jsxs("span",{className:"font-medium text-foreground",children:[a.progress,"%"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-3 sm:grid-cols-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:t("asset.dashboard.byStatus")}),["planned","in-progress","review","approved","integrated","deprecated"].map(i=>{const o=a.byStatus.get(i)??0;if(o===0)return null;const x=Math.round(o/a.total*100);return e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("span",{className:"w-16 truncate",children:t(`asset.status.${i}`)}),e.jsx("div",{className:"h-1.5 flex-1 overflow-hidden rounded-full bg-muted",children:e.jsx("div",{className:`h-full rounded-full ${Ss[i]}`,style:{width:`${x}%`}})}),e.jsx("span",{className:"w-6 text-right text-muted-foreground",children:o})]},i)})]}),l.length>0&&e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:t("asset.dashboard.byCategory")}),l.slice(0,6).map(({category:i,count:o})=>{const x=Math.round(o/g*100),r=u.has(i)?t(`asset.cat.${i}`):i;return e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("span",{className:"w-16 truncate",title:r,children:r}),e.jsx("div",{className:"h-1.5 flex-1 overflow-hidden rounded-full bg-muted",children:e.jsx("div",{className:"h-full rounded-full bg-violet-500",style:{width:`${x}%`}})}),e.jsx("span",{className:"w-6 text-right text-muted-foreground",children:o})]},i)}),l.length>6&&e.jsxs("span",{className:"text-[10px] text-muted-foreground",children:["+",l.length-6," more"]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:t("asset.dashboard.byPriority")}),["high","medium","low"].map(i=>{const o=a.byPriority.get(i)??0;if(o===0)return null;const x=Math.round(o/a.total*100);return e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("span",{className:"w-16 truncate",children:t(`asset.priority.${i}`)}),e.jsx("div",{className:"h-1.5 flex-1 overflow-hidden rounded-full bg-muted",children:e.jsx("div",{className:`h-full rounded-full ${zs[i]}`,style:{width:`${x}%`}})}),e.jsx("span",{className:"w-6 text-right text-muted-foreground",children:o})]},i)})]}),a.byAssignee.size>0&&e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:t("asset.dashboard.byAssignee")}),[...a.byAssignee.entries()].sort((i,o)=>o[1].total-i[1].total).slice(0,6).map(([i,{total:o,done:x}])=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"truncate",children:i==="__none__"?e.jsx("span",{className:"italic text-muted-foreground",children:t("asset.dashboard.unassigned")}):i}),e.jsxs("span",{className:"ml-2 shrink-0 text-muted-foreground",children:[x,"/",o]})]},i))]})]})]})}const Ms=["character-art","environment-art","ui-art","icon","animation","vfx","bgm","sfx","voice","video","font","prefab","other"],Ds=["planned","in-progress","review","approved","integrated","deprecated"];function Ys(){const t=E(),c=R(),s=pe(),{id:a}=we(),{documents:l,open:u,create:g,currentDocument:i}=Ee(),{assets:o,customCategories:x,assignees:r,load:v,reset:N,addAsset:n,addCustomCategory:p,addAssignee:j,filterSearch:T,filterCategory:_,filterStatus:Y,filterAssignee:q,setFilterSearch:fe,setFilterCategory:O,setFilterStatus:H,setFilterAssignee:$}=h(),[V,F]=m.useState(null),[U,je]=m.useState(!1);m.useEffect(()=>{if(!a)return;const d=l.find(re=>re.type==="asset-registry");d?u(d.id):g(a,"asset-registry","Asset Registry")},[a]),m.useEffect(()=>{if(i?.type==="asset-registry"){const d=i;v(d.assets,d.customCategories,d.assignees)}return()=>{N()}},[i?.id]);const X=m.useRef(i);X.current=i;const ye=m.useMemo(()=>{const d=X.current;return!d||d.type!=="asset-registry"?null:{...d,assets:o,customCategories:x.length>0?x:void 0,assignees:r.length>0?r:void 0,updatedAt:Date.now()}},[i?.id,o,x,r]);Re(ye);const ve=m.useCallback(()=>F(null),[]),Z=m.useCallback(()=>{const d=n({name:t("asset.untitled")});F(d.id)},[n,t]),Q=m.useCallback(()=>{i&&Te("assets.json",i)},[i]),W=m.useCallback(()=>{if(!i||i.type!=="asset-registry")return;const d=Se(i);ze("assets.md",d,"text/markdown")},[i]),K=m.useCallback(async d=>{if(await s({title:t("ie.importConfirm"),variant:"destructive"}))try{const I=JSON.parse(d);if(I.type!=="asset-registry")return;v(I.assets,I.customCategories,I.assignees)}catch{}},[s,t,v]),ee=m.useMemo(()=>[{key:"ie.importJson",icon:le,accept:".json",onImport:K}],[K]),se=m.useMemo(()=>[{key:"export.currentJson",icon:le,onClick:Q},{key:"export.currentMd",icon:Ie,onClick:W}],[Q,W]),te=m.useCallback(async()=>{const d=await c({title:t("asset.addCategory"),placeholder:t("asset.addCategory")});d&&p(d)},[c,t,p]),ae=m.useCallback(async()=>{const d=await c({title:t("asset.addAssignee"),placeholder:t("asset.addAssignee")});d&&j(d)},[c,t,j]);return Me(i?e.jsxs(e.Fragment,{children:[e.jsx(Ge,{value:T,onChange:fe,placeholder:t("table.search")}),e.jsx(L,{orientation:"vertical",className:"mx-0.5 h-6"}),e.jsxs(B,{children:[e.jsxs(A,{children:[e.jsx(k,{asChild:!0,children:e.jsx(G,{asChild:!0,children:e.jsx(y,{variant:_!=="all"?"secondary":"ghost",size:"icon",className:"size-9",children:e.jsx(Je,{className:"size-4"})})})}),e.jsx(w,{side:"top",children:t("asset.category")})]}),e.jsxs(J,{side:"top",align:"start",className:"max-h-60 overflow-y-auto",children:[e.jsx(b,{onClick:()=>O("all"),children:t("asset.allCategories")}),Ms.map(d=>e.jsx(b,{onClick:()=>O(d),children:t(`asset.cat.${d}`)},d)),x.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(M,{}),x.map(d=>e.jsx(b,{onClick:()=>O(d),children:d},d))]}),e.jsx(M,{}),e.jsxs(b,{onClick:te,children:["＋ ",t("asset.addCategory")]})]})]}),e.jsxs(B,{children:[e.jsxs(A,{children:[e.jsx(k,{asChild:!0,children:e.jsx(G,{asChild:!0,children:e.jsx(y,{variant:Y!=="all"?"secondary":"ghost",size:"icon",className:"size-9",children:e.jsx(Ye,{className:"size-4"})})})}),e.jsx(w,{side:"top",children:t("asset.statusLabel")})]}),e.jsxs(J,{side:"top",align:"start",children:[e.jsx(b,{onClick:()=>H("all"),children:t("asset.allStatuses")}),Ds.map(d=>e.jsx(b,{onClick:()=>H(d),children:t(`asset.status.${d}`)},d))]})]}),e.jsxs(B,{children:[e.jsxs(A,{children:[e.jsx(k,{asChild:!0,children:e.jsx(G,{asChild:!0,children:e.jsx(y,{variant:q!=="all"?"secondary":"ghost",size:"icon",className:"size-9",children:e.jsx(qe,{className:"size-4"})})})}),e.jsx(w,{side:"top",children:t("asset.assignee")})]}),e.jsxs(J,{side:"top",align:"start",children:[e.jsx(b,{onClick:()=>$("all"),children:t("asset.allAssignees")}),e.jsx(b,{onClick:()=>$("__none__"),children:t("asset.noAssignee")}),r.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(M,{}),r.map(d=>e.jsx(b,{onClick:()=>$(d),children:d},d))]}),e.jsx(M,{}),e.jsxs(b,{onClick:ae,children:["＋ ",t("asset.addAssignee")]})]})]}),e.jsx(L,{orientation:"vertical",className:"mx-0.5 h-6"}),e.jsxs(A,{children:[e.jsx(k,{asChild:!0,children:e.jsx(y,{variant:U?"secondary":"ghost",size:"icon",className:"size-9",onClick:()=>je(d=>!d),children:e.jsx(He,{className:"size-4"})})}),e.jsx(w,{side:"top",children:t("asset.dashboard")})]}),e.jsxs(De,{children:[e.jsxs(A,{children:[e.jsx(k,{asChild:!0,children:e.jsx(Le,{asChild:!0,children:e.jsx(y,{variant:"ghost",size:"icon",className:"size-9",children:e.jsx(Xe,{className:"size-4"})})})}),e.jsx(w,{side:"top",children:t("asset.settings")})]}),e.jsx(Pe,{side:"top",align:"start",className:"p-0",children:e.jsx(Ts,{})})]}),e.jsxs(A,{children:[e.jsx(k,{asChild:!0,children:e.jsx(y,{variant:"ghost",size:"icon",className:"size-9",onClick:Z,children:e.jsx(P,{className:"size-4"})})}),e.jsx(w,{side:"top",children:t("asset.add")})]}),e.jsx(Oe,{imports:ee,exports:se}),e.jsx($e,{section:"資源清單"})]}):null,[i,Z,ee,se,te,ae,T,_,Y,q,x,r,U,t]),i?e.jsxs("div",{className:"flex h-full flex-col",children:[U&&e.jsx(Is,{}),V&&e.jsx(ws,{assetId:V,onClose:ve}),e.jsx("div",{className:"min-h-0 flex-1",children:e.jsx(ls,{selectedId:V,onSelect:F})})]}):null}export{Ys as default};
