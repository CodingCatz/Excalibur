import{c as v,j as e,B as h,aK as g,aB as b,r as c,b6 as w,a$ as k,b0 as C,b7 as y,b1 as N,b8 as T,b9 as m,ba as x,bb as f,aH as E,bc as R}from"./index-BO31ZqPg.js";import{P as I,a as D,C as L,b as M,c as _,u as z}from"./useReadmeHelp-Dp5zdwnQ.js";const A=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],S=v("arrow-up-down",A);function P({section:a,subsection:o}){const{html:s,loading:r}=z(a,o);return r?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx(g,{className:"size-4 animate-spin text-muted-foreground"})}):e.jsx("div",{className:"prose prose-xs dark:prose-invert max-w-none [&_table]:text-xs [&_th]:px-2 [&_th]:py-1 [&_td]:px-2 [&_td]:py-1",dangerouslySetInnerHTML:{__html:s}})}function U({children:a,section:o,subsection:s}){return e.jsxs(I,{children:[e.jsx(D,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"icon",className:"ml-auto size-9 shrink-0",children:e.jsx(L,{className:"size-4 text-muted-foreground"})})}),e.jsxs(M,{side:"top",className:"max-h-80 w-80 overflow-y-auto text-xs leading-relaxed",children:[e.jsx(_,{}),o?e.jsx(P,{section:o,subsection:s}):a]})]})}function V({imports:a,exports:o,toggles:s}){const r=b(),l=c.useRef(null),t=c.useRef(null),d=c.useCallback(n=>{t.current={accept:n.accept,onImport:n.onImport},l.current&&(l.current.accept=n.accept,l.current.value="",l.current.click())},[]),i=c.useCallback(n=>{const u=n.target.files?.[0];if(!u||!t.current)return;const j=t.current,p=new FileReader;p.onload=()=>{j.onImport(p.result,u.name)},p.readAsText(u),t.current=null},[]);return e.jsxs(e.Fragment,{children:[e.jsxs(w,{children:[e.jsxs(k,{children:[e.jsx(C,{asChild:!0,children:e.jsx(y,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"icon",className:"size-9",children:e.jsx(S,{className:"size-4"})})})}),e.jsxs(N,{side:"top",children:[r("ie.import")," / ",r("ie.export")]})]}),e.jsxs(T,{side:"top",align:"start",className:"w-52",children:[e.jsx(m,{className:"text-xs text-muted-foreground",children:r("ie.import")}),a.map(n=>e.jsxs(x,{onClick:()=>d(n),children:[e.jsx(n.icon,{className:"mr-2 size-4"}),r(n.key)]},n.key)),e.jsx(f,{}),e.jsx(m,{className:"text-xs text-muted-foreground",children:r("ie.export")}),o.map(n=>e.jsxs(x,{onClick:n.onClick,children:[e.jsx(n.icon,{className:"mr-2 size-4"}),r(n.key)]},n.key)),s&&s.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(f,{}),s.map(n=>e.jsxs(x,{onClick:n.onClick,children:[e.jsx(n.icon,{className:"mr-2 size-4"}),r(n.key),n.active&&e.jsx("span",{className:"ml-auto text-xs text-muted-foreground",children:"âœ“"})]},n.key))]})]})]}),e.jsx("input",{ref:l,type:"file",className:"hidden",onChange:i})]})}const H=3e3;function q(a){const o=E(i=>i.save),s=c.useRef(null),r=c.useRef(null),l=c.useRef(null),t=c.useCallback(()=>{r.current&&(R.saveDocument(r.current),r.current=null)},[]),d=c.useCallback(async()=>{s.current&&(clearTimeout(s.current),s.current=null),r.current&&(await o(r.current),r.current=null)},[o]);return c.useEffect(()=>{if(!a){r.current=null;return}const i=l.current,n=a.id;return i&&i!==n&&t(),l.current=n,r.current=a,s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{o(a),r.current=null,s.current=null},H),()=>{s.current&&clearTimeout(s.current)}},[a,o,t]),c.useEffect(()=>{const i=()=>{document.visibilityState==="hidden"&&t()},n=()=>t(),u=()=>t();return document.addEventListener("visibilitychange",i),window.addEventListener("beforeunload",n),window.addEventListener("pagehide",u),()=>{document.removeEventListener("visibilitychange",i),window.removeEventListener("beforeunload",n),window.removeEventListener("pagehide",u),t()}},[t]),d}export{V as I,U as T,q as u};
